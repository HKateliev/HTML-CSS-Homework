{"ast":null,"code":"'use strict';\n\n// tar -c\nconst hlo = require('./high-level-opt.js');\nconst Pack = require('./pack.js');\nconst fs = require('fs');\nconst fsm = require('fs-minipass');\nconst t = require('./list.js');\nconst path = require('path');\nconst c = module.exports = (opt_, files, cb) => {\n  if (typeof files === 'function') cb = files;\n  if (Array.isArray(opt_)) files = opt_, opt_ = {};\n  if (!files || !Array.isArray(files) || !files.length) throw new TypeError('no files or directories specified');\n  files = Array.from(files);\n  const opt = hlo(opt_);\n  if (opt.sync && typeof cb === 'function') throw new TypeError('callback not supported for sync tar functions');\n  if (!opt.file && typeof cb === 'function') throw new TypeError('callback only supported with file option');\n  return opt.file && opt.sync ? createFileSync(opt, files) : opt.file ? createFile(opt, files, cb) : opt.sync ? createSync(opt, files) : create(opt, files);\n};\nconst createFileSync = (opt, files) => {\n  const p = new Pack.Sync(opt);\n  const stream = new fsm.WriteStreamSync(opt.file, {\n    mode: opt.mode || 0o666\n  });\n  p.pipe(stream);\n  addFilesSync(p, files);\n};\nconst createFile = (opt, files, cb) => {\n  const p = new Pack(opt);\n  const stream = new fsm.WriteStream(opt.file, {\n    mode: opt.mode || 0o666\n  });\n  p.pipe(stream);\n  const promise = new Promise((res, rej) => {\n    stream.on('error', rej);\n    stream.on('close', res);\n    p.on('error', rej);\n  });\n  addFilesAsync(p, files);\n  return cb ? promise.then(cb, cb) : promise;\n};\nconst addFilesSync = (p, files) => {\n  files.forEach(file => {\n    if (file.charAt(0) === '@') t({\n      file: path.resolve(p.cwd, file.substr(1)),\n      sync: true,\n      noResume: true,\n      onentry: entry => p.add(entry)\n    });else p.add(file);\n  });\n  p.end();\n};\nconst addFilesAsync = (p, files) => {\n  while (files.length) {\n    const file = files.shift();\n    if (file.charAt(0) === '@') return t({\n      file: path.resolve(p.cwd, file.substr(1)),\n      noResume: true,\n      onentry: entry => p.add(entry)\n    }).then(_ => addFilesAsync(p, files));else p.add(file);\n  }\n  p.end();\n};\nconst createSync = (opt, files) => {\n  const p = new Pack.Sync(opt);\n  addFilesSync(p, files);\n  return p;\n};\nconst create = (opt, files) => {\n  const p = new Pack(opt);\n  addFilesAsync(p, files);\n  return p;\n};","map":{"version":3,"names":["hlo","require","Pack","fs","fsm","t","path","c","module","exports","opt_","files","cb","Array","isArray","length","TypeError","from","opt","sync","file","createFileSync","createFile","createSync","create","p","Sync","stream","WriteStreamSync","mode","pipe","addFilesSync","WriteStream","promise","Promise","res","rej","on","addFilesAsync","then","forEach","charAt","resolve","cwd","substr","noResume","onentry","entry","add","end","shift","_"],"sources":["/Users/hkateliev/node_modules/npm/node_modules/tar/lib/create.js"],"sourcesContent":["'use strict'\n\n// tar -c\nconst hlo = require('./high-level-opt.js')\n\nconst Pack = require('./pack.js')\nconst fs = require('fs')\nconst fsm = require('fs-minipass')\nconst t = require('./list.js')\nconst path = require('path')\n\nconst c = module.exports = (opt_, files, cb) => {\n  if (typeof files === 'function')\n    cb = files\n\n  if (Array.isArray(opt_))\n    files = opt_, opt_ = {}\n\n  if (!files || !Array.isArray(files) || !files.length)\n    throw new TypeError('no files or directories specified')\n\n  files = Array.from(files)\n\n  const opt = hlo(opt_)\n\n  if (opt.sync && typeof cb === 'function')\n    throw new TypeError('callback not supported for sync tar functions')\n\n  if (!opt.file && typeof cb === 'function')\n    throw new TypeError('callback only supported with file option')\n\n  return opt.file && opt.sync ? createFileSync(opt, files)\n    : opt.file ? createFile(opt, files, cb)\n    : opt.sync ? createSync(opt, files)\n    : create(opt, files)\n}\n\nconst createFileSync = (opt, files) => {\n  const p = new Pack.Sync(opt)\n  const stream = new fsm.WriteStreamSync(opt.file, {\n    mode: opt.mode || 0o666\n  })\n  p.pipe(stream)\n  addFilesSync(p, files)\n}\n\nconst createFile = (opt, files, cb) => {\n  const p = new Pack(opt)\n  const stream = new fsm.WriteStream(opt.file, {\n    mode: opt.mode || 0o666\n  })\n  p.pipe(stream)\n\n  const promise = new Promise((res, rej) => {\n    stream.on('error', rej)\n    stream.on('close', res)\n    p.on('error', rej)\n  })\n\n  addFilesAsync(p, files)\n\n  return cb ? promise.then(cb, cb) : promise\n}\n\nconst addFilesSync = (p, files) => {\n  files.forEach(file => {\n    if (file.charAt(0) === '@')\n      t({\n        file: path.resolve(p.cwd, file.substr(1)),\n        sync: true,\n        noResume: true,\n        onentry: entry => p.add(entry)\n      })\n    else\n      p.add(file)\n  })\n  p.end()\n}\n\nconst addFilesAsync = (p, files) => {\n  while (files.length) {\n    const file = files.shift()\n    if (file.charAt(0) === '@')\n      return t({\n        file: path.resolve(p.cwd, file.substr(1)),\n        noResume: true,\n        onentry: entry => p.add(entry)\n      }).then(_ => addFilesAsync(p, files))\n    else\n      p.add(file)\n  }\n  p.end()\n}\n\nconst createSync = (opt, files) => {\n  const p = new Pack.Sync(opt)\n  addFilesSync(p, files)\n  return p\n}\n\nconst create = (opt, files) => {\n  const p = new Pack(opt)\n  addFilesAsync(p, files)\n  return p\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}