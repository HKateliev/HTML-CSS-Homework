{"ast":null,"code":"module.exports = errorHandler;\nmodule.exports.exit = exit;\nvar cbCalled = false;\nvar log = require('npmlog');\nvar npm = require('../npm.js');\nvar itWorked = false;\nvar path = require('path');\nvar wroteLogFile = false;\nvar exitCode = 0;\nvar rollbacks = npm.rollbacks;\nvar chain = require('slide').chain;\nvar errorMessage = require('./error-message.js');\nvar replaceInfo = require('./replace-info.js');\nvar stopMetrics = require('./metrics.js').stop;\nconst cacheFile = require('./cache-file.js');\nvar logFileName;\nfunction getLogFile() {\n  if (!logFileName) {\n    logFileName = path.resolve(npm.config.get('cache'), '_logs', new Date().toISOString().replace(/[.:]/g, '_') + '-debug.log');\n  }\n  return logFileName;\n}\nvar timings = {\n  version: npm.version,\n  command: process.argv.slice(2),\n  logfile: null\n};\nprocess.on('timing', function (name, value) {\n  if (timings[name]) {\n    timings[name] += value;\n  } else {\n    timings[name] = value;\n  }\n});\nprocess.on('exit', function (code) {\n  process.emit('timeEnd', 'npm');\n  log.disableProgress();\n  if (npm.config && npm.config.loaded && npm.config.get('timing')) {\n    try {\n      timings.logfile = getLogFile();\n      cacheFile.append('_timing.json', JSON.stringify(timings) + '\\n');\n    } catch (_) {\n      // ignore\n    }\n  }\n\n  // kill any outstanding stats reporter if it hasn't finished yet\n  stopMetrics();\n  if (code) itWorked = false;\n  if (itWorked) {\n    log.info('ok');\n  } else {\n    if (!cbCalled) {\n      log.error('', 'cb() never called!');\n      console.error('');\n      log.error('', 'This is an error with npm itself. Please report this error at:');\n      log.error('', '    <https://npm.community>');\n      writeLogFile();\n    }\n    if (code) {\n      log.verbose('code', code);\n    }\n  }\n  if (npm.config && npm.config.loaded && npm.config.get('timing') && !wroteLogFile) writeLogFile();\n  if (wroteLogFile) {\n    // just a line break\n    if (log.levels[log.level] <= log.levels.error) console.error('');\n    log.error('', ['A complete log of this run can be found in:', '    ' + getLogFile()].join('\\n'));\n    wroteLogFile = false;\n  }\n  var doExit = npm.config && npm.config.loaded && npm.config.get('_exit');\n  if (doExit) {\n    // actually exit.\n    if (exitCode === 0 && !itWorked) {\n      exitCode = 1;\n    }\n    if (exitCode !== 0) process.exit(exitCode);\n  } else {\n    itWorked = false; // ready for next exit\n  }\n});\n\nfunction exit(code, noLog) {\n  exitCode = exitCode || process.exitCode || code;\n  var doExit = npm.config && npm.config.loaded ? npm.config.get('_exit') : true;\n  log.verbose('exit', [code, doExit]);\n  if (log.level === 'silent') noLog = true;\n  if (rollbacks.length) {\n    chain(rollbacks.map(function (f) {\n      return function (cb) {\n        npm.commands.unbuild([f], true, cb);\n      };\n    }), function (er) {\n      if (er) {\n        log.error('error rolling back', er);\n        if (!code) {\n          errorHandler(er);\n        } else {\n          if (!noLog) writeLogFile();\n          reallyExit(er);\n        }\n      } else {\n        if (!noLog && code) writeLogFile();\n        reallyExit();\n      }\n    });\n    rollbacks.length = 0;\n  } else if (code && !noLog) {\n    writeLogFile();\n  } else {\n    reallyExit();\n  }\n  function reallyExit(er) {\n    if (er && !code) code = typeof er.errno === 'number' ? er.errno : 1;\n    itWorked = !code;\n\n    // Exit directly -- nothing in the CLI should still be running in the\n    // background at this point, and this makes sure anything left dangling\n    // for whatever reason gets thrown away, instead of leaving the CLI open\n    //\n    // Commands that expect long-running actions should just delay `cb()`\n    process.stdout.write('', () => {\n      process.exit(code);\n    });\n  }\n}\nfunction errorHandler(er) {\n  log.disableProgress();\n  if (!npm.config || !npm.config.loaded) {\n    // logging won't work unless we pretend that it's ready\n    er = er || new Error('Exit prior to config file resolving.');\n    console.error(er.stack || er.message);\n  }\n  if (cbCalled) {\n    er = er || new Error('Callback called more than once.');\n  }\n  cbCalled = true;\n  if (!er) return exit(0);\n  if (typeof er === 'string') {\n    log.error('', er);\n    return exit(1, true);\n  } else if (!(er instanceof Error)) {\n    log.error('weird error', er);\n    return exit(1, true);\n  }\n  var m = er.code || er.message.match(/^(?:Error: )?(E[A-Z]+)/);\n  if (m && !er.code) {\n    er.code = m;\n  }\n  ;\n  ['type', 'stack', 'statusCode', 'pkgid'].forEach(function (k) {\n    var v = er[k];\n    if (!v) return;\n    v = replaceInfo(v);\n    log.verbose(k, v);\n  });\n  log.verbose('cwd', process.cwd());\n  var os = require('os');\n  var args = replaceInfo(process.argv);\n  log.verbose('', os.type() + ' ' + os.release());\n  log.verbose('argv', args.map(JSON.stringify).join(' '));\n  log.verbose('node', process.version);\n  log.verbose('npm ', 'v' + npm.version);\n  ['code', 'syscall', 'file', 'path', 'dest', 'errno'].forEach(function (k) {\n    var v = er[k];\n    if (v) log.error(k, v);\n  });\n  var msg = errorMessage(er);\n  msg.summary.concat(msg.detail).forEach(function (errline) {\n    log.error.apply(log, errline);\n  });\n  if (npm.config && npm.config.get('json')) {\n    var error = {\n      error: {\n        code: er.code,\n        summary: messageText(msg.summary),\n        detail: messageText(msg.detail)\n      }\n    };\n    console.log(JSON.stringify(error, null, 2));\n  }\n  exit(typeof er.errno === 'number' ? er.errno : 1);\n}\nfunction messageText(msg) {\n  return msg.map(function (line) {\n    return line.slice(1).join(' ');\n  }).join('\\n');\n}\nfunction writeLogFile() {\n  if (wroteLogFile) return;\n  var os = require('os');\n  try {\n    var logOutput = '';\n    log.record.forEach(function (m) {\n      var pref = [m.id, m.level];\n      if (m.prefix) pref.push(m.prefix);\n      pref = pref.join(' ');\n      m.message.trim().split(/\\r?\\n/).map(function (line) {\n        return (pref + ' ' + line).trim();\n      }).forEach(function (line) {\n        logOutput += line + os.EOL;\n      });\n    });\n    cacheFile.write(getLogFile(), logOutput);\n\n    // truncate once it's been written.\n    log.record.length = 0;\n    wroteLogFile = true;\n  } catch (ex) {}\n}","map":{"version":3,"names":["module","exports","errorHandler","exit","cbCalled","log","require","npm","itWorked","path","wroteLogFile","exitCode","rollbacks","chain","errorMessage","replaceInfo","stopMetrics","stop","cacheFile","logFileName","getLogFile","resolve","config","get","Date","toISOString","replace","timings","version","command","process","argv","slice","logfile","on","name","value","code","emit","disableProgress","loaded","append","JSON","stringify","_","info","error","console","writeLogFile","verbose","levels","level","join","doExit","noLog","length","map","f","cb","commands","unbuild","er","reallyExit","errno","stdout","write","Error","stack","message","m","match","forEach","k","v","cwd","os","args","type","release","msg","summary","concat","detail","errline","apply","messageText","line","logOutput","record","pref","id","prefix","push","trim","split","EOL","ex"],"sources":["/Users/hkateliev/node_modules/npm/lib/utils/error-handler.js"],"sourcesContent":["\nmodule.exports = errorHandler\nmodule.exports.exit = exit\n\nvar cbCalled = false\nvar log = require('npmlog')\nvar npm = require('../npm.js')\nvar itWorked = false\nvar path = require('path')\nvar wroteLogFile = false\nvar exitCode = 0\nvar rollbacks = npm.rollbacks\nvar chain = require('slide').chain\nvar errorMessage = require('./error-message.js')\nvar replaceInfo = require('./replace-info.js')\nvar stopMetrics = require('./metrics.js').stop\n\nconst cacheFile = require('./cache-file.js')\n\nvar logFileName\nfunction getLogFile () {\n  if (!logFileName) {\n    logFileName = path.resolve(npm.config.get('cache'), '_logs', (new Date()).toISOString().replace(/[.:]/g, '_') + '-debug.log')\n  }\n  return logFileName\n}\n\nvar timings = {\n  version: npm.version,\n  command: process.argv.slice(2),\n  logfile: null\n}\nprocess.on('timing', function (name, value) {\n  if (timings[name]) { timings[name] += value } else { timings[name] = value }\n})\n\nprocess.on('exit', function (code) {\n  process.emit('timeEnd', 'npm')\n  log.disableProgress()\n  if (npm.config && npm.config.loaded && npm.config.get('timing')) {\n    try {\n      timings.logfile = getLogFile()\n      cacheFile.append('_timing.json', JSON.stringify(timings) + '\\n')\n    } catch (_) {\n      // ignore\n    }\n  }\n\n  // kill any outstanding stats reporter if it hasn't finished yet\n  stopMetrics()\n\n  if (code) itWorked = false\n  if (itWorked) {\n    log.info('ok')\n  } else {\n    if (!cbCalled) {\n      log.error('', 'cb() never called!')\n      console.error('')\n      log.error('', 'This is an error with npm itself. Please report this error at:')\n      log.error('', '    <https://npm.community>')\n      writeLogFile()\n    }\n\n    if (code) {\n      log.verbose('code', code)\n    }\n  }\n  if (npm.config && npm.config.loaded && npm.config.get('timing') && !wroteLogFile) writeLogFile()\n  if (wroteLogFile) {\n    // just a line break\n    if (log.levels[log.level] <= log.levels.error) console.error('')\n\n    log.error(\n      '',\n      [\n        'A complete log of this run can be found in:',\n        '    ' + getLogFile()\n      ].join('\\n')\n    )\n    wroteLogFile = false\n  }\n\n  var doExit = npm.config && npm.config.loaded && npm.config.get('_exit')\n  if (doExit) {\n    // actually exit.\n    if (exitCode === 0 && !itWorked) {\n      exitCode = 1\n    }\n    if (exitCode !== 0) process.exit(exitCode)\n  } else {\n    itWorked = false // ready for next exit\n  }\n})\n\nfunction exit (code, noLog) {\n  exitCode = exitCode || process.exitCode || code\n\n  var doExit = npm.config && npm.config.loaded ? npm.config.get('_exit') : true\n  log.verbose('exit', [code, doExit])\n  if (log.level === 'silent') noLog = true\n\n  if (rollbacks.length) {\n    chain(rollbacks.map(function (f) {\n      return function (cb) {\n        npm.commands.unbuild([f], true, cb)\n      }\n    }), function (er) {\n      if (er) {\n        log.error('error rolling back', er)\n        if (!code) {\n          errorHandler(er)\n        } else {\n          if (!noLog) writeLogFile()\n          reallyExit(er)\n        }\n      } else {\n        if (!noLog && code) writeLogFile()\n        reallyExit()\n      }\n    })\n    rollbacks.length = 0\n  } else if (code && !noLog) {\n    writeLogFile()\n  } else {\n    reallyExit()\n  }\n\n  function reallyExit (er) {\n    if (er && !code) code = typeof er.errno === 'number' ? er.errno : 1\n\n    itWorked = !code\n\n    // Exit directly -- nothing in the CLI should still be running in the\n    // background at this point, and this makes sure anything left dangling\n    // for whatever reason gets thrown away, instead of leaving the CLI open\n    //\n    // Commands that expect long-running actions should just delay `cb()`\n    process.stdout.write('', () => {\n      process.exit(code)\n    })\n  }\n}\n\nfunction errorHandler (er) {\n  log.disableProgress()\n  if (!npm.config || !npm.config.loaded) {\n    // logging won't work unless we pretend that it's ready\n    er = er || new Error('Exit prior to config file resolving.')\n    console.error(er.stack || er.message)\n  }\n\n  if (cbCalled) {\n    er = er || new Error('Callback called more than once.')\n  }\n\n  cbCalled = true\n  if (!er) return exit(0)\n  if (typeof er === 'string') {\n    log.error('', er)\n    return exit(1, true)\n  } else if (!(er instanceof Error)) {\n    log.error('weird error', er)\n    return exit(1, true)\n  }\n\n  var m = er.code || er.message.match(/^(?:Error: )?(E[A-Z]+)/)\n  if (m && !er.code) {\n    er.code = m\n  }\n\n  ;[\n    'type',\n    'stack',\n    'statusCode',\n    'pkgid'\n  ].forEach(function (k) {\n    var v = er[k]\n    if (!v) return\n    v = replaceInfo(v)\n    log.verbose(k, v)\n  })\n\n  log.verbose('cwd', process.cwd())\n\n  var os = require('os')\n  var args = replaceInfo(process.argv)\n  log.verbose('', os.type() + ' ' + os.release())\n  log.verbose('argv', args.map(JSON.stringify).join(' '))\n  log.verbose('node', process.version)\n  log.verbose('npm ', 'v' + npm.version)\n\n  ;[\n    'code',\n    'syscall',\n    'file',\n    'path',\n    'dest',\n    'errno'\n  ].forEach(function (k) {\n    var v = er[k]\n    if (v) log.error(k, v)\n  })\n\n  var msg = errorMessage(er)\n  msg.summary.concat(msg.detail).forEach(function (errline) {\n    log.error.apply(log, errline)\n  })\n  if (npm.config && npm.config.get('json')) {\n    var error = {\n      error: {\n        code: er.code,\n        summary: messageText(msg.summary),\n        detail: messageText(msg.detail)\n      }\n    }\n    console.log(JSON.stringify(error, null, 2))\n  }\n\n  exit(typeof er.errno === 'number' ? er.errno : 1)\n}\n\nfunction messageText (msg) {\n  return msg.map(function (line) {\n    return line.slice(1).join(' ')\n  }).join('\\n')\n}\n\nfunction writeLogFile () {\n  if (wroteLogFile) return\n\n  var os = require('os')\n\n  try {\n    var logOutput = ''\n    log.record.forEach(function (m) {\n      var pref = [m.id, m.level]\n      if (m.prefix) pref.push(m.prefix)\n      pref = pref.join(' ')\n\n      m.message.trim().split(/\\r?\\n/).map(function (line) {\n        return (pref + ' ' + line).trim()\n      }).forEach(function (line) {\n        logOutput += line + os.EOL\n      })\n    })\n    cacheFile.write(getLogFile(), logOutput)\n\n    // truncate once it's been written.\n    log.record.length = 0\n    wroteLogFile = true\n  } catch (ex) {\n\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}