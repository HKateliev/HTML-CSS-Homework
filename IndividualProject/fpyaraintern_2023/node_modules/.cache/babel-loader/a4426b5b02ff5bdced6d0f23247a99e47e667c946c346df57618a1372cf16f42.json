{"ast":null,"code":"module.exports = setUser;\nvar assert = require('assert');\nvar path = require('path');\nvar fs = require('fs');\nvar mkdirp = require('gentle-fs').mkdir;\nfunction setUser(cb) {\n  var defaultConf = this.root;\n  assert(defaultConf !== Object.prototype);\n\n  // If global, leave it as-is.\n  // If not global, then set the user to the owner of the prefix folder.\n  // Just set the default, so it can be overridden.\n  if (this.get('global')) return cb();\n  if (process.env.SUDO_UID) {\n    defaultConf.user = +process.env.SUDO_UID;\n    return cb();\n  }\n  var prefix = path.resolve(this.get('prefix'));\n  mkdirp(prefix, function (er) {\n    if (er) return cb(er);\n    fs.stat(prefix, function (er, st) {\n      defaultConf.user = st && st.uid;\n      return cb(er);\n    });\n  });\n}","map":{"version":3,"names":["module","exports","setUser","assert","require","path","fs","mkdirp","mkdir","cb","defaultConf","root","Object","prototype","get","process","env","SUDO_UID","user","prefix","resolve","er","stat","st","uid"],"sources":["/Users/hkateliev/node_modules/npm/lib/config/set-user.js"],"sourcesContent":["module.exports = setUser\n\nvar assert = require('assert')\nvar path = require('path')\nvar fs = require('fs')\nvar mkdirp = require('gentle-fs').mkdir\n\nfunction setUser (cb) {\n  var defaultConf = this.root\n  assert(defaultConf !== Object.prototype)\n\n  // If global, leave it as-is.\n  // If not global, then set the user to the owner of the prefix folder.\n  // Just set the default, so it can be overridden.\n  if (this.get('global')) return cb()\n  if (process.env.SUDO_UID) {\n    defaultConf.user = +(process.env.SUDO_UID)\n    return cb()\n  }\n\n  var prefix = path.resolve(this.get('prefix'))\n  mkdirp(prefix, function (er) {\n    if (er) return cb(er)\n    fs.stat(prefix, function (er, st) {\n      defaultConf.user = st && st.uid\n      return cb(er)\n    })\n  })\n}\n"],"mappings":"AAAAA,MAAM,CAACC,OAAO,GAAGC,OAAO;AAExB,IAAIC,MAAM,GAAGC,OAAO,CAAC,QAAQ,CAAC;AAC9B,IAAIC,IAAI,GAAGD,OAAO,CAAC,MAAM,CAAC;AAC1B,IAAIE,EAAE,GAAGF,OAAO,CAAC,IAAI,CAAC;AACtB,IAAIG,MAAM,GAAGH,OAAO,CAAC,WAAW,CAAC,CAACI,KAAK;AAEvC,SAASN,OAAOA,CAAEO,EAAE,EAAE;EACpB,IAAIC,WAAW,GAAG,IAAI,CAACC,IAAI;EAC3BR,MAAM,CAACO,WAAW,KAAKE,MAAM,CAACC,SAAS,CAAC;;EAExC;EACA;EACA;EACA,IAAI,IAAI,CAACC,GAAG,CAAC,QAAQ,CAAC,EAAE,OAAOL,EAAE,EAAE;EACnC,IAAIM,OAAO,CAACC,GAAG,CAACC,QAAQ,EAAE;IACxBP,WAAW,CAACQ,IAAI,GAAG,CAAEH,OAAO,CAACC,GAAG,CAACC,QAAS;IAC1C,OAAOR,EAAE,EAAE;EACb;EAEA,IAAIU,MAAM,GAAGd,IAAI,CAACe,OAAO,CAAC,IAAI,CAACN,GAAG,CAAC,QAAQ,CAAC,CAAC;EAC7CP,MAAM,CAACY,MAAM,EAAE,UAAUE,EAAE,EAAE;IAC3B,IAAIA,EAAE,EAAE,OAAOZ,EAAE,CAACY,EAAE,CAAC;IACrBf,EAAE,CAACgB,IAAI,CAACH,MAAM,EAAE,UAAUE,EAAE,EAAEE,EAAE,EAAE;MAChCb,WAAW,CAACQ,IAAI,GAAGK,EAAE,IAAIA,EAAE,CAACC,GAAG;MAC/B,OAAOf,EAAE,CAACY,EAAE,CAAC;IACf,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ"},"metadata":{},"sourceType":"script","externalDependencies":[]}