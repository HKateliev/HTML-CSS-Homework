{"ast":null,"code":"'use strict';\n\nexports.severityLabel = severityLabel;\nexports.color = color;\nexports.totalVulnCount = totalVulnCount;\nexports.severities = severities;\nconst ccs = require('console-control-strings');\nconst severityColors = {\n  critical: {\n    color: 'brightMagenta',\n    label: 'Critical'\n  },\n  high: {\n    color: 'brightRed',\n    label: 'High'\n  },\n  moderate: {\n    color: 'brightYellow',\n    label: 'Moderate'\n  },\n  low: {\n    color: 'bold',\n    label: 'Low'\n  },\n  info: {\n    color: '',\n    label: 'Info'\n  }\n};\nfunction color(value, colorName, withColor) {\n  return colorName && withColor ? ccs.color(colorName) + value + ccs.color('reset') : value;\n}\nfunction severityLabel(sev, withColor, bold) {\n  if (!(sev in severityColors)) return sev.charAt(0).toUpperCase() + sev.substr(1).toLowerCase();\n  let colorName = severityColors[sev].color;\n  if (bold) colorName = [colorName, 'bold'];\n  return color(severityColors[sev].label, colorName, withColor);\n}\nfunction totalVulnCount(vulns) {\n  return Object.keys(vulns).reduce((accumulator, key) => {\n    const vulnCount = vulns[key];\n    accumulator += vulnCount;\n    return accumulator;\n  }, 0);\n}\nfunction severities(vulns) {\n  return Object.keys(vulns).reduce((accumulator, severity) => {\n    const vulnCount = vulns[severity];\n    if (vulnCount > 0) accumulator.push([severity, vulnCount]);\n    return accumulator;\n  }, []);\n}","map":{"version":3,"names":["exports","severityLabel","color","totalVulnCount","severities","ccs","require","severityColors","critical","label","high","moderate","low","info","value","colorName","withColor","sev","bold","charAt","toUpperCase","substr","toLowerCase","vulns","Object","keys","reduce","accumulator","key","vulnCount","severity","push"],"sources":["/Users/hkateliev/node_modules/npm/node_modules/npm-audit-report/lib/utils.js"],"sourcesContent":["'use strict'\n\nexports.severityLabel = severityLabel\nexports.color = color\nexports.totalVulnCount = totalVulnCount\nexports.severities = severities\n\nconst ccs = require('console-control-strings')\n\nconst severityColors = {\n  critical: {\n    color: 'brightMagenta',\n    label: 'Critical'\n  },\n  high: {\n    color: 'brightRed',\n    label: 'High'\n  },\n  moderate: {\n    color: 'brightYellow',\n    label: 'Moderate'\n  },\n  low: {\n    color: 'bold',\n    label: 'Low'\n  },\n  info: {\n    color: '',\n    label: 'Info'\n  }\n}\n\nfunction color (value, colorName, withColor) {\n  return (colorName && withColor) ? ccs.color(colorName) + value + ccs.color('reset') : value\n}\n\nfunction severityLabel (sev, withColor, bold) {\n  if (!(sev in severityColors)) return sev.charAt(0).toUpperCase() + sev.substr(1).toLowerCase()\n  let colorName = severityColors[sev].color\n  if (bold) colorName = [colorName, 'bold']\n  return color(severityColors[sev].label, colorName, withColor)\n}\n\nfunction totalVulnCount (vulns) {\n  return Object.keys(vulns).reduce((accumulator, key) => {\n    const vulnCount = vulns[key]\n    accumulator += vulnCount\n\n    return accumulator\n  }, 0)\n}\n\nfunction severities (vulns) {\n  return Object.keys(vulns).reduce((accumulator, severity) => {\n    const vulnCount = vulns[severity]\n    if (vulnCount > 0) accumulator.push([severity, vulnCount])\n\n    return accumulator\n  }, [])\n}\n"],"mappings":"AAAA,YAAY;;AAEZA,OAAO,CAACC,aAAa,GAAGA,aAAa;AACrCD,OAAO,CAACE,KAAK,GAAGA,KAAK;AACrBF,OAAO,CAACG,cAAc,GAAGA,cAAc;AACvCH,OAAO,CAACI,UAAU,GAAGA,UAAU;AAE/B,MAAMC,GAAG,GAAGC,OAAO,CAAC,yBAAyB,CAAC;AAE9C,MAAMC,cAAc,GAAG;EACrBC,QAAQ,EAAE;IACRN,KAAK,EAAE,eAAe;IACtBO,KAAK,EAAE;EACT,CAAC;EACDC,IAAI,EAAE;IACJR,KAAK,EAAE,WAAW;IAClBO,KAAK,EAAE;EACT,CAAC;EACDE,QAAQ,EAAE;IACRT,KAAK,EAAE,cAAc;IACrBO,KAAK,EAAE;EACT,CAAC;EACDG,GAAG,EAAE;IACHV,KAAK,EAAE,MAAM;IACbO,KAAK,EAAE;EACT,CAAC;EACDI,IAAI,EAAE;IACJX,KAAK,EAAE,EAAE;IACTO,KAAK,EAAE;EACT;AACF,CAAC;AAED,SAASP,KAAKA,CAAEY,KAAK,EAAEC,SAAS,EAAEC,SAAS,EAAE;EAC3C,OAAQD,SAAS,IAAIC,SAAS,GAAIX,GAAG,CAACH,KAAK,CAACa,SAAS,CAAC,GAAGD,KAAK,GAAGT,GAAG,CAACH,KAAK,CAAC,OAAO,CAAC,GAAGY,KAAK;AAC7F;AAEA,SAASb,aAAaA,CAAEgB,GAAG,EAAED,SAAS,EAAEE,IAAI,EAAE;EAC5C,IAAI,EAAED,GAAG,IAAIV,cAAc,CAAC,EAAE,OAAOU,GAAG,CAACE,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,EAAE,GAAGH,GAAG,CAACI,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,EAAE;EAC9F,IAAIP,SAAS,GAAGR,cAAc,CAACU,GAAG,CAAC,CAACf,KAAK;EACzC,IAAIgB,IAAI,EAAEH,SAAS,GAAG,CAACA,SAAS,EAAE,MAAM,CAAC;EACzC,OAAOb,KAAK,CAACK,cAAc,CAACU,GAAG,CAAC,CAACR,KAAK,EAAEM,SAAS,EAAEC,SAAS,CAAC;AAC/D;AAEA,SAASb,cAAcA,CAAEoB,KAAK,EAAE;EAC9B,OAAOC,MAAM,CAACC,IAAI,CAACF,KAAK,CAAC,CAACG,MAAM,CAAC,CAACC,WAAW,EAAEC,GAAG,KAAK;IACrD,MAAMC,SAAS,GAAGN,KAAK,CAACK,GAAG,CAAC;IAC5BD,WAAW,IAAIE,SAAS;IAExB,OAAOF,WAAW;EACpB,CAAC,EAAE,CAAC,CAAC;AACP;AAEA,SAASvB,UAAUA,CAAEmB,KAAK,EAAE;EAC1B,OAAOC,MAAM,CAACC,IAAI,CAACF,KAAK,CAAC,CAACG,MAAM,CAAC,CAACC,WAAW,EAAEG,QAAQ,KAAK;IAC1D,MAAMD,SAAS,GAAGN,KAAK,CAACO,QAAQ,CAAC;IACjC,IAAID,SAAS,GAAG,CAAC,EAAEF,WAAW,CAACI,IAAI,CAAC,CAACD,QAAQ,EAAED,SAAS,CAAC,CAAC;IAE1D,OAAOF,WAAW;EACpB,CAAC,EAAE,EAAE,CAAC;AACR"},"metadata":{},"sourceType":"script","externalDependencies":[]}