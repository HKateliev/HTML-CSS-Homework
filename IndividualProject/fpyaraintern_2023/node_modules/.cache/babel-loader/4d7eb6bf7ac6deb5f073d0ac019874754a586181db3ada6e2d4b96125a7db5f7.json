{"ast":null,"code":"var fs;\ntry {\n  fs = require('graceful-fs');\n} catch (er) {\n  fs = require('fs');\n}\nvar path = require('path');\nvar glob = require('glob');\nvar normalizeData = require('normalize-package-data');\nvar safeJSON = require('json-parse-better-errors');\nvar util = require('util');\nvar normalizePackageBin = require('npm-normalize-package-bin');\nmodule.exports = readJson;\n\n// put more stuff on here to customize.\nreadJson.extraSet = [bundleDependencies, gypfile, serverjs, scriptpath, authors, readme, mans, bins, githead];\nvar typoWarned = {};\nvar cache = {};\nfunction readJson(file, log_, strict_, cb_) {\n  var log, strict, cb;\n  for (var i = 1; i < arguments.length - 1; i++) {\n    if (typeof arguments[i] === 'boolean') {\n      strict = arguments[i];\n    } else if (typeof arguments[i] === 'function') {\n      log = arguments[i];\n    }\n  }\n  if (!log) log = function () {};\n  cb = arguments[arguments.length - 1];\n  readJson_(file, log, strict, cb);\n}\nfunction readJson_(file, log, strict, cb) {\n  fs.readFile(file, 'utf8', function (er, d) {\n    parseJson(file, er, d, log, strict, cb);\n  });\n}\nfunction stripBOM(content) {\n  // Remove byte order marker. This catches EF BB BF (the UTF-8 BOM)\n  // because the buffer-to-string conversion in `fs.readFileSync()`\n  // translates it to FEFF, the UTF-16 BOM.\n  if (content.charCodeAt(0) === 0xFEFF) content = content.slice(1);\n  return content;\n}\nfunction jsonClone(obj) {\n  if (obj == null) {\n    return obj;\n  } else if (Array.isArray(obj)) {\n    var newarr = new Array(obj.length);\n    for (var ii in obj) {\n      newarr[ii] = obj[ii];\n    }\n  } else if (typeof obj === 'object') {\n    var newobj = {};\n    for (var kk in obj) {\n      newobj[kk] = jsonClone[kk];\n    }\n  } else {\n    return obj;\n  }\n}\nfunction parseJson(file, er, d, log, strict, cb) {\n  if (er && er.code === 'ENOENT') {\n    return fs.stat(path.dirname(file), function (err, stat) {\n      if (!err && stat && !stat.isDirectory()) {\n        // ENOTDIR isn't used on Windows, but npm expects it.\n        er = Object.create(er);\n        er.code = 'ENOTDIR';\n        return cb(er);\n      } else {\n        return indexjs(file, er, log, strict, cb);\n      }\n    });\n  }\n  if (er) return cb(er);\n  if (cache[d]) return cb(null, jsonClone(cache[d]));\n  var data;\n  try {\n    data = safeJSON(stripBOM(d));\n  } catch (er) {\n    data = parseIndex(d);\n    if (!data) return cb(parseError(er, file));\n  }\n  extrasCached(file, d, data, log, strict, cb);\n}\nfunction extrasCached(file, d, data, log, strict, cb) {\n  extras(file, data, log, strict, function (err, data) {\n    if (!err) {\n      cache[d] = jsonClone(data);\n    }\n    cb(err, data);\n  });\n}\nfunction indexjs(file, er, log, strict, cb) {\n  if (path.basename(file) === 'index.js') return cb(er);\n  var index = path.resolve(path.dirname(file), 'index.js');\n  fs.readFile(index, 'utf8', function (er2, d) {\n    if (er2) return cb(er);\n    if (cache[d]) return cb(null, cache[d]);\n    var data = parseIndex(d);\n    if (!data) return cb(er);\n    extrasCached(file, d, data, log, strict, cb);\n  });\n}\nreadJson.extras = extras;\nfunction extras(file, data, log_, strict_, cb_) {\n  var log, strict, cb;\n  for (var i = 2; i < arguments.length - 1; i++) {\n    if (typeof arguments[i] === 'boolean') {\n      strict = arguments[i];\n    } else if (typeof arguments[i] === 'function') {\n      log = arguments[i];\n    }\n  }\n  if (!log) log = function () {};\n  cb = arguments[i];\n  var set = readJson.extraSet;\n  var n = set.length;\n  var errState = null;\n  set.forEach(function (fn) {\n    fn(file, data, then);\n  });\n  function then(er) {\n    if (errState) return;\n    if (er) return cb(errState = er);\n    if (--n > 0) return;\n    final(file, data, log, strict, cb);\n  }\n}\nfunction scriptpath(file, data, cb) {\n  if (!data.scripts) return cb(null, data);\n  var k = Object.keys(data.scripts);\n  k.forEach(scriptpath_, data.scripts);\n  cb(null, data);\n}\nfunction scriptpath_(key) {\n  var s = this[key];\n  // This is never allowed, and only causes problems\n  if (typeof s !== 'string') return delete this[key];\n  var spre = /^(\\.[/\\\\])?node_modules[/\\\\].bin[\\\\/]/;\n  if (s.match(spre)) {\n    this[key] = this[key].replace(spre, '');\n  }\n}\nfunction gypfile(file, data, cb) {\n  var dir = path.dirname(file);\n  var s = data.scripts || {};\n  if (s.install || s.preinstall) return cb(null, data);\n  glob('*.gyp', {\n    cwd: dir\n  }, function (er, files) {\n    if (er) return cb(er);\n    if (data.gypfile === false) return cb(null, data);\n    gypfile_(file, data, files, cb);\n  });\n}\nfunction gypfile_(file, data, files, cb) {\n  if (!files.length) return cb(null, data);\n  var s = data.scripts || {};\n  s.install = 'node-gyp rebuild';\n  data.scripts = s;\n  data.gypfile = true;\n  return cb(null, data);\n}\nfunction serverjs(file, data, cb) {\n  var dir = path.dirname(file);\n  var s = data.scripts || {};\n  if (s.start) return cb(null, data);\n  glob('server.js', {\n    cwd: dir\n  }, function (er, files) {\n    if (er) return cb(er);\n    serverjs_(file, data, files, cb);\n  });\n}\nfunction serverjs_(file, data, files, cb) {\n  if (!files.length) return cb(null, data);\n  var s = data.scripts || {};\n  s.start = 'node server.js';\n  data.scripts = s;\n  return cb(null, data);\n}\nfunction authors(file, data, cb) {\n  if (data.contributors) return cb(null, data);\n  var af = path.resolve(path.dirname(file), 'AUTHORS');\n  fs.readFile(af, 'utf8', function (er, ad) {\n    // ignore error.  just checking it.\n    if (er) return cb(null, data);\n    authors_(file, data, ad, cb);\n  });\n}\nfunction authors_(file, data, ad, cb) {\n  ad = ad.split(/\\r?\\n/g).map(function (line) {\n    return line.replace(/^\\s*#.*$/, '').trim();\n  }).filter(function (line) {\n    return line;\n  });\n  data.contributors = ad;\n  return cb(null, data);\n}\nfunction readme(file, data, cb) {\n  if (data.readme) return cb(null, data);\n  var dir = path.dirname(file);\n  var globOpts = {\n    cwd: dir,\n    nocase: true,\n    mark: true\n  };\n  glob('{README,README.*}', globOpts, function (er, files) {\n    if (er) return cb(er);\n    // don't accept directories.\n    files = files.filter(function (file) {\n      return !file.match(/\\/$/);\n    });\n    if (!files.length) return cb();\n    var fn = preferMarkdownReadme(files);\n    var rm = path.resolve(dir, fn);\n    readme_(file, data, rm, cb);\n  });\n}\nfunction preferMarkdownReadme(files) {\n  var fallback = 0;\n  var re = /\\.m?a?r?k?d?o?w?n?$/i;\n  for (var i = 0; i < files.length; i++) {\n    if (files[i].match(re)) {\n      return files[i];\n    } else if (files[i].match(/README$/)) {\n      fallback = i;\n    }\n  }\n  // prefer README.md, followed by README; otherwise, return\n  // the first filename (which could be README)\n  return files[fallback];\n}\nfunction readme_(file, data, rm, cb) {\n  var rmfn = path.basename(rm);\n  fs.readFile(rm, 'utf8', function (er, rm) {\n    // maybe not readable, or something.\n    if (er) return cb();\n    data.readme = rm;\n    data.readmeFilename = rmfn;\n    return cb(er, data);\n  });\n}\nfunction mans(file, data, cb) {\n  var m = data.directories && data.directories.man;\n  if (data.man || !m) return cb(null, data);\n  m = path.resolve(path.dirname(file), m);\n  glob('**/*.[0-9]', {\n    cwd: m\n  }, function (er, mans) {\n    if (er) return cb(er);\n    mans_(file, data, mans, cb);\n  });\n}\nfunction mans_(file, data, mans, cb) {\n  var m = data.directories && data.directories.man;\n  data.man = mans.map(function (mf) {\n    return path.resolve(path.dirname(file), m, mf);\n  });\n  return cb(null, data);\n}\nfunction bins(file, data, cb) {\n  data = normalizePackageBin(data);\n  var m = data.directories && data.directories.bin;\n  if (data.bin || !m) return cb(null, data);\n  m = path.resolve(path.dirname(file), m);\n  glob('**', {\n    cwd: m\n  }, function (er, bins) {\n    if (er) return cb(er);\n    bins_(file, data, bins, cb);\n  });\n}\nfunction bins_(file, data, bins, cb) {\n  var m = data.directories && data.directories.bin || '.';\n  data.bin = bins.reduce(function (acc, mf) {\n    if (mf && mf.charAt(0) !== '.') {\n      var f = path.basename(mf);\n      acc[f] = path.join(m, mf);\n    }\n    return acc;\n  }, {});\n  return cb(null, normalizePackageBin(data));\n}\nfunction bundleDependencies(file, data, cb) {\n  var bd = 'bundleDependencies';\n  var bdd = 'bundledDependencies';\n  // normalize key name\n  if (data[bdd] !== undefined) {\n    if (data[bd] === undefined) data[bd] = data[bdd];\n    delete data[bdd];\n  }\n  if (data[bd] === false) delete data[bd];else if (data[bd] === true) {\n    data[bd] = Object.keys(data.dependencies || {});\n  } else if (data[bd] !== undefined && !Array.isArray(data[bd])) {\n    delete data[bd];\n  }\n  return cb(null, data);\n}\nfunction githead(file, data, cb) {\n  if (data.gitHead) return cb(null, data);\n  var dir = path.dirname(file);\n  var head = path.resolve(dir, '.git/HEAD');\n  fs.readFile(head, 'utf8', function (er, head) {\n    if (er) return cb(null, data);\n    githead_(file, data, dir, head, cb);\n  });\n}\nfunction githead_(file, data, dir, head, cb) {\n  if (!head.match(/^ref: /)) {\n    data.gitHead = head.trim();\n    return cb(null, data);\n  }\n  var headRef = head.replace(/^ref: /, '').trim();\n  var headFile = path.resolve(dir, '.git', headRef);\n  fs.readFile(headFile, 'utf8', function (er, head) {\n    if (er || !head) {\n      var packFile = path.resolve(dir, '.git/packed-refs');\n      return fs.readFile(packFile, 'utf8', function (er, refs) {\n        if (er || !refs) {\n          return cb(null, data);\n        }\n        refs = refs.split('\\n');\n        for (var i = 0; i < refs.length; i++) {\n          var match = refs[i].match(/^([0-9a-f]{40}) (.+)$/);\n          if (match && match[2].trim() === headRef) {\n            data.gitHead = match[1];\n            break;\n          }\n        }\n        return cb(null, data);\n      });\n    }\n    head = head.replace(/^ref: /, '').trim();\n    data.gitHead = head;\n    return cb(null, data);\n  });\n}\n\n/**\n * Warn if the bin references don't point to anything.  This might be better in\n * normalize-package-data if it had access to the file path.\n */\nfunction checkBinReferences_(file, data, warn, cb) {\n  if (!(data.bin instanceof Object)) return cb();\n  var keys = Object.keys(data.bin);\n  var keysLeft = keys.length;\n  if (!keysLeft) return cb();\n  function handleExists(relName, result) {\n    keysLeft--;\n    if (!result) warn('No bin file found at ' + relName);\n    if (!keysLeft) cb();\n  }\n  keys.forEach(function (key) {\n    var dirName = path.dirname(file);\n    var relName = data.bin[key];\n    /* istanbul ignore if - impossible, bins have been normalized */\n    if (typeof relName !== 'string') {\n      var msg = 'Bin filename for ' + key + ' is not a string: ' + util.inspect(relName);\n      warn(msg);\n      delete data.bin[key];\n      handleExists(relName, true);\n      return;\n    }\n    var binPath = path.resolve(dirName, relName);\n    fs.stat(binPath, err => handleExists(relName, !err));\n  });\n}\nfunction final(file, data, log, strict, cb) {\n  var pId = makePackageId(data);\n  function warn(msg) {\n    if (typoWarned[pId]) return;\n    if (log) log('package.json', pId, msg);\n  }\n  try {\n    normalizeData(data, warn, strict);\n  } catch (error) {\n    return cb(error);\n  }\n  checkBinReferences_(file, data, warn, function () {\n    typoWarned[pId] = true;\n    cb(null, data);\n  });\n}\nfunction makePackageId(data) {\n  var name = cleanString(data.name);\n  var ver = cleanString(data.version);\n  return name + '@' + ver;\n}\nfunction cleanString(str) {\n  return !str || typeof str !== 'string' ? '' : str.trim();\n}\n\n// /**package { \"name\": \"foo\", \"version\": \"1.2.3\", ... } **/\nfunction parseIndex(data) {\n  data = data.split(/^\\/\\*\\*package(?:\\s|$)/m);\n  if (data.length < 2) return null;\n  data = data[1];\n  data = data.split(/\\*\\*\\/$/m);\n  if (data.length < 2) return null;\n  data = data[0];\n  data = data.replace(/^\\s*\\*/mg, '');\n  try {\n    return safeJSON(data);\n  } catch (er) {\n    return null;\n  }\n}\nfunction parseError(ex, file) {\n  var e = new Error('Failed to parse json\\n' + ex.message);\n  e.code = 'EJSONPARSE';\n  e.file = file;\n  return e;\n}","map":{"version":3,"names":["fs","require","er","path","glob","normalizeData","safeJSON","util","normalizePackageBin","module","exports","readJson","extraSet","bundleDependencies","gypfile","serverjs","scriptpath","authors","readme","mans","bins","githead","typoWarned","cache","file","log_","strict_","cb_","log","strict","cb","i","arguments","length","readJson_","readFile","d","parseJson","stripBOM","content","charCodeAt","slice","jsonClone","obj","Array","isArray","newarr","ii","newobj","kk","code","stat","dirname","err","isDirectory","Object","create","indexjs","data","parseIndex","parseError","extrasCached","extras","basename","index","resolve","er2","set","n","errState","forEach","fn","then","final","scripts","k","keys","scriptpath_","key","s","spre","match","replace","dir","install","preinstall","cwd","files","gypfile_","start","serverjs_","contributors","af","ad","authors_","split","map","line","trim","filter","globOpts","nocase","mark","preferMarkdownReadme","rm","readme_","fallback","re","rmfn","readmeFilename","m","directories","man","mans_","mf","bin","bins_","reduce","acc","charAt","f","join","bd","bdd","undefined","dependencies","gitHead","head","githead_","headRef","headFile","packFile","refs","checkBinReferences_","warn","keysLeft","handleExists","relName","result","dirName","msg","inspect","binPath","pId","makePackageId","error","name","cleanString","ver","version","str","ex","e","Error","message"],"sources":["/Users/hkateliev/node_modules/npm/node_modules/read-package-json/read-json.js"],"sourcesContent":["var fs\ntry {\n  fs = require('graceful-fs')\n} catch (er) {\n  fs = require('fs')\n}\n\nvar path = require('path')\n\nvar glob = require('glob')\nvar normalizeData = require('normalize-package-data')\nvar safeJSON = require('json-parse-better-errors')\nvar util = require('util')\nvar normalizePackageBin = require('npm-normalize-package-bin')\n\nmodule.exports = readJson\n\n// put more stuff on here to customize.\nreadJson.extraSet = [\n  bundleDependencies,\n  gypfile,\n  serverjs,\n  scriptpath,\n  authors,\n  readme,\n  mans,\n  bins,\n  githead\n]\n\nvar typoWarned = {}\nvar cache = {}\n\nfunction readJson (file, log_, strict_, cb_) {\n  var log, strict, cb\n  for (var i = 1; i < arguments.length - 1; i++) {\n    if (typeof arguments[i] === 'boolean') {\n      strict = arguments[i]\n    } else if (typeof arguments[i] === 'function') {\n      log = arguments[i]\n    }\n  }\n\n  if (!log) log = function () {}\n  cb = arguments[ arguments.length - 1 ]\n\n  readJson_(file, log, strict, cb)\n}\n\nfunction readJson_ (file, log, strict, cb) {\n  fs.readFile(file, 'utf8', function (er, d) {\n    parseJson(file, er, d, log, strict, cb)\n  })\n}\n\nfunction stripBOM (content) {\n  // Remove byte order marker. This catches EF BB BF (the UTF-8 BOM)\n  // because the buffer-to-string conversion in `fs.readFileSync()`\n  // translates it to FEFF, the UTF-16 BOM.\n  if (content.charCodeAt(0) === 0xFEFF) content = content.slice(1)\n  return content\n}\n\nfunction jsonClone (obj) {\n  if (obj == null) {\n    return obj\n  } else if (Array.isArray(obj)) {\n    var newarr = new Array(obj.length)\n    for (var ii in obj) {\n      newarr[ii] = obj[ii]\n    }\n  } else if (typeof obj === 'object') {\n    var newobj = {}\n    for (var kk in obj) {\n      newobj[kk] = jsonClone[kk]\n    }\n  } else {\n    return obj\n  }\n}\n\nfunction parseJson (file, er, d, log, strict, cb) {\n  if (er && er.code === 'ENOENT') {\n    return fs.stat(path.dirname(file), function (err, stat) {\n      if (!err && stat && !stat.isDirectory()) {\n        // ENOTDIR isn't used on Windows, but npm expects it.\n        er = Object.create(er)\n        er.code = 'ENOTDIR'\n        return cb(er)\n      } else {\n        return indexjs(file, er, log, strict, cb)\n      }\n    })\n  }\n  if (er) return cb(er)\n\n  if (cache[d]) return cb(null, jsonClone(cache[d]))\n\n  var data\n\n  try {\n    data = safeJSON(stripBOM(d))\n  } catch (er) {\n    data = parseIndex(d)\n    if (!data) return cb(parseError(er, file))\n  }\n\n  extrasCached(file, d, data, log, strict, cb)\n}\n\nfunction extrasCached (file, d, data, log, strict, cb) {\n  extras(file, data, log, strict, function (err, data) {\n    if (!err) {\n      cache[d] = jsonClone(data)\n    }\n    cb(err, data)\n  })\n}\n\nfunction indexjs (file, er, log, strict, cb) {\n  if (path.basename(file) === 'index.js') return cb(er)\n\n  var index = path.resolve(path.dirname(file), 'index.js')\n  fs.readFile(index, 'utf8', function (er2, d) {\n    if (er2) return cb(er)\n\n    if (cache[d]) return cb(null, cache[d])\n\n    var data = parseIndex(d)\n    if (!data) return cb(er)\n\n    extrasCached(file, d, data, log, strict, cb)\n  })\n}\n\nreadJson.extras = extras\nfunction extras (file, data, log_, strict_, cb_) {\n  var log, strict, cb\n  for (var i = 2; i < arguments.length - 1; i++) {\n    if (typeof arguments[i] === 'boolean') {\n      strict = arguments[i]\n    } else if (typeof arguments[i] === 'function') {\n      log = arguments[i]\n    }\n  }\n\n  if (!log) log = function () {}\n  cb = arguments[i]\n\n  var set = readJson.extraSet\n  var n = set.length\n  var errState = null\n  set.forEach(function (fn) {\n    fn(file, data, then)\n  })\n\n  function then (er) {\n    if (errState) return\n    if (er) return cb(errState = er)\n    if (--n > 0) return\n    final(file, data, log, strict, cb)\n  }\n}\n\nfunction scriptpath (file, data, cb) {\n  if (!data.scripts) return cb(null, data)\n  var k = Object.keys(data.scripts)\n  k.forEach(scriptpath_, data.scripts)\n  cb(null, data)\n}\n\nfunction scriptpath_ (key) {\n  var s = this[key]\n  // This is never allowed, and only causes problems\n  if (typeof s !== 'string') return delete this[key]\n\n  var spre = /^(\\.[/\\\\])?node_modules[/\\\\].bin[\\\\/]/\n  if (s.match(spre)) {\n    this[key] = this[key].replace(spre, '')\n  }\n}\n\nfunction gypfile (file, data, cb) {\n  var dir = path.dirname(file)\n  var s = data.scripts || {}\n  if (s.install || s.preinstall) return cb(null, data)\n\n  glob('*.gyp', { cwd: dir }, function (er, files) {\n    if (er) return cb(er)\n    if (data.gypfile === false) return cb(null, data)\n    gypfile_(file, data, files, cb)\n  })\n}\n\nfunction gypfile_ (file, data, files, cb) {\n  if (!files.length) return cb(null, data)\n  var s = data.scripts || {}\n  s.install = 'node-gyp rebuild'\n  data.scripts = s\n  data.gypfile = true\n  return cb(null, data)\n}\n\nfunction serverjs (file, data, cb) {\n  var dir = path.dirname(file)\n  var s = data.scripts || {}\n  if (s.start) return cb(null, data)\n  glob('server.js', { cwd: dir }, function (er, files) {\n    if (er) return cb(er)\n    serverjs_(file, data, files, cb)\n  })\n}\n\nfunction serverjs_ (file, data, files, cb) {\n  if (!files.length) return cb(null, data)\n  var s = data.scripts || {}\n  s.start = 'node server.js'\n  data.scripts = s\n  return cb(null, data)\n}\n\nfunction authors (file, data, cb) {\n  if (data.contributors) return cb(null, data)\n  var af = path.resolve(path.dirname(file), 'AUTHORS')\n  fs.readFile(af, 'utf8', function (er, ad) {\n    // ignore error.  just checking it.\n    if (er) return cb(null, data)\n    authors_(file, data, ad, cb)\n  })\n}\n\nfunction authors_ (file, data, ad, cb) {\n  ad = ad.split(/\\r?\\n/g).map(function (line) {\n    return line.replace(/^\\s*#.*$/, '').trim()\n  }).filter(function (line) {\n    return line\n  })\n  data.contributors = ad\n  return cb(null, data)\n}\n\nfunction readme (file, data, cb) {\n  if (data.readme) return cb(null, data)\n  var dir = path.dirname(file)\n  var globOpts = { cwd: dir, nocase: true, mark: true }\n  glob('{README,README.*}', globOpts, function (er, files) {\n    if (er) return cb(er)\n    // don't accept directories.\n    files = files.filter(function (file) {\n      return !file.match(/\\/$/)\n    })\n    if (!files.length) return cb()\n    var fn = preferMarkdownReadme(files)\n    var rm = path.resolve(dir, fn)\n    readme_(file, data, rm, cb)\n  })\n}\n\nfunction preferMarkdownReadme (files) {\n  var fallback = 0\n  var re = /\\.m?a?r?k?d?o?w?n?$/i\n  for (var i = 0; i < files.length; i++) {\n    if (files[i].match(re)) {\n      return files[i]\n    } else if (files[i].match(/README$/)) {\n      fallback = i\n    }\n  }\n  // prefer README.md, followed by README; otherwise, return\n  // the first filename (which could be README)\n  return files[fallback]\n}\n\nfunction readme_ (file, data, rm, cb) {\n  var rmfn = path.basename(rm)\n  fs.readFile(rm, 'utf8', function (er, rm) {\n    // maybe not readable, or something.\n    if (er) return cb()\n    data.readme = rm\n    data.readmeFilename = rmfn\n    return cb(er, data)\n  })\n}\n\nfunction mans (file, data, cb) {\n  var m = data.directories && data.directories.man\n  if (data.man || !m) return cb(null, data)\n  m = path.resolve(path.dirname(file), m)\n  glob('**/*.[0-9]', { cwd: m }, function (er, mans) {\n    if (er) return cb(er)\n    mans_(file, data, mans, cb)\n  })\n}\n\nfunction mans_ (file, data, mans, cb) {\n  var m = data.directories && data.directories.man\n  data.man = mans.map(function (mf) {\n    return path.resolve(path.dirname(file), m, mf)\n  })\n  return cb(null, data)\n}\n\nfunction bins (file, data, cb) {\n  data = normalizePackageBin(data)\n\n  var m = data.directories && data.directories.bin\n  if (data.bin || !m) return cb(null, data)\n\n  m = path.resolve(path.dirname(file), m)\n  glob('**', { cwd: m }, function (er, bins) {\n    if (er) return cb(er)\n    bins_(file, data, bins, cb)\n  })\n}\n\nfunction bins_ (file, data, bins, cb) {\n  var m = (data.directories && data.directories.bin) || '.'\n  data.bin = bins.reduce(function (acc, mf) {\n    if (mf && mf.charAt(0) !== '.') {\n      var f = path.basename(mf)\n      acc[f] = path.join(m, mf)\n    }\n    return acc\n  }, {})\n  return cb(null, normalizePackageBin(data))\n}\n\nfunction bundleDependencies (file, data, cb) {\n  var bd = 'bundleDependencies'\n  var bdd = 'bundledDependencies'\n  // normalize key name\n  if (data[bdd] !== undefined) {\n    if (data[bd] === undefined) data[bd] = data[bdd]\n    delete data[bdd]\n  }\n  if (data[bd] === false) delete data[bd]\n  else if (data[bd] === true) {\n    data[bd] = Object.keys(data.dependencies || {})\n  } else if (data[bd] !== undefined && !Array.isArray(data[bd])) {\n    delete data[bd]\n  }\n  return cb(null, data)\n}\n\nfunction githead (file, data, cb) {\n  if (data.gitHead) return cb(null, data)\n  var dir = path.dirname(file)\n  var head = path.resolve(dir, '.git/HEAD')\n  fs.readFile(head, 'utf8', function (er, head) {\n    if (er) return cb(null, data)\n    githead_(file, data, dir, head, cb)\n  })\n}\n\nfunction githead_ (file, data, dir, head, cb) {\n  if (!head.match(/^ref: /)) {\n    data.gitHead = head.trim()\n    return cb(null, data)\n  }\n  var headRef = head.replace(/^ref: /, '').trim()\n  var headFile = path.resolve(dir, '.git', headRef)\n  fs.readFile(headFile, 'utf8', function (er, head) {\n    if (er || !head) {\n      var packFile = path.resolve(dir, '.git/packed-refs')\n      return fs.readFile(packFile, 'utf8', function (er, refs) {\n        if (er || !refs) {\n          return cb(null, data)\n        }\n        refs = refs.split('\\n')\n        for (var i = 0; i < refs.length; i++) {\n          var match = refs[i].match(/^([0-9a-f]{40}) (.+)$/)\n          if (match && match[2].trim() === headRef) {\n            data.gitHead = match[1]\n            break\n          }\n        }\n        return cb(null, data)\n      })\n    }\n    head = head.replace(/^ref: /, '').trim()\n    data.gitHead = head\n    return cb(null, data)\n  })\n}\n\n/**\n * Warn if the bin references don't point to anything.  This might be better in\n * normalize-package-data if it had access to the file path.\n */\nfunction checkBinReferences_ (file, data, warn, cb) {\n  if (!(data.bin instanceof Object)) return cb()\n\n  var keys = Object.keys(data.bin)\n  var keysLeft = keys.length\n  if (!keysLeft) return cb()\n\n  function handleExists (relName, result) {\n    keysLeft--\n    if (!result) warn('No bin file found at ' + relName)\n    if (!keysLeft) cb()\n  }\n\n  keys.forEach(function (key) {\n    var dirName = path.dirname(file)\n    var relName = data.bin[key]\n    /* istanbul ignore if - impossible, bins have been normalized */\n    if (typeof relName !== 'string') {\n      var msg = 'Bin filename for ' + key +\n        ' is not a string: ' + util.inspect(relName)\n      warn(msg)\n      delete data.bin[key]\n      handleExists(relName, true)\n      return\n    }\n    var binPath = path.resolve(dirName, relName)\n    fs.stat(binPath, (err) => handleExists(relName, !err))\n  })\n}\n\nfunction final (file, data, log, strict, cb) {\n  var pId = makePackageId(data)\n\n  function warn (msg) {\n    if (typoWarned[pId]) return\n    if (log) log('package.json', pId, msg)\n  }\n\n  try {\n    normalizeData(data, warn, strict)\n  } catch (error) {\n    return cb(error)\n  }\n\n  checkBinReferences_(file, data, warn, function () {\n    typoWarned[pId] = true\n    cb(null, data)\n  })\n}\n\nfunction makePackageId (data) {\n  var name = cleanString(data.name)\n  var ver = cleanString(data.version)\n  return name + '@' + ver\n}\n\nfunction cleanString (str) {\n  return (!str || typeof (str) !== 'string') ? '' : str.trim()\n}\n\n// /**package { \"name\": \"foo\", \"version\": \"1.2.3\", ... } **/\nfunction parseIndex (data) {\n  data = data.split(/^\\/\\*\\*package(?:\\s|$)/m)\n\n  if (data.length < 2) return null\n  data = data[1]\n  data = data.split(/\\*\\*\\/$/m)\n\n  if (data.length < 2) return null\n  data = data[0]\n  data = data.replace(/^\\s*\\*/mg, '')\n\n  try {\n    return safeJSON(data)\n  } catch (er) {\n    return null\n  }\n}\n\nfunction parseError (ex, file) {\n  var e = new Error('Failed to parse json\\n' + ex.message)\n  e.code = 'EJSONPARSE'\n  e.file = file\n  return e\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}