{"ast":null,"code":"'use strict';\n\nconst report = function (data, options) {\n  const defaults = {\n    severityThreshold: 'info'\n  };\n  const config = Object.assign({}, defaults, options);\n  let exit = 0;\n  const actions = function (data, config) {\n    let accumulator = {\n      critical: '',\n      high: '',\n      moderate: '',\n      low: ''\n    };\n    if (Object.keys(data.advisories).length !== 0) {\n      data.actions.forEach(action => {\n        let l = {};\n        // Start with install/update actions\n        if (action.action === 'update' || action.action === 'install') {\n          const recommendation = getRecommendation(action, config);\n          l.recommendation = recommendation.cmd;\n          l.breaking = recommendation.isBreaking ? 'Y' : 'N';\n          action.resolves.forEach(resolution => {\n            const advisory = data.advisories[resolution.id];\n            l.sevLevel = advisory.severity;\n            l.severity = advisory.title;\n            l.package = advisory.module_name;\n            l.moreInfo = advisory.url || `https://www.npmjs.com/advisories/${advisory.id}`;\n            l.path = resolution.path;\n            accumulator[advisory.severity] += [action.action, l.package, l.sevLevel, l.recommendation, l.severity, l.moreInfo, l.path, l.breaking].join('\\t') + '\\n';\n          }); // forEach resolves\n        }\n\n        if (action.action === 'review') {\n          action.resolves.forEach(resolution => {\n            const advisory = data.advisories[resolution.id];\n            l.sevLevel = advisory.severity;\n            l.severity = advisory.title;\n            l.package = advisory.module_name;\n            l.moreInfo = advisory.url || `https://www.npmjs.com/advisories/${advisory.id}`;\n            l.patchedIn = advisory.patched_versions.replace(' ', '') === '<0.0.0' ? 'No patch available' : advisory.patched_versions;\n            l.path = resolution.path;\n            accumulator[advisory.severity] += [action.action, l.package, l.sevLevel, l.patchedIn, l.severity, l.moreInfo, l.path].join('\\t') + '\\n';\n          }); // forEach resolves\n        } // is review\n      }); // forEach actions\n    }\n\n    return accumulator['critical'] + accumulator['high'] + accumulator['moderate'] + accumulator['low'];\n  };\n  const exitCode = function (metadata) {\n    let total = 0;\n    const keys = Object.keys(metadata.vulnerabilities);\n    for (let key of keys) {\n      const value = metadata.vulnerabilities[key];\n      total = total + value;\n    }\n    if (total > 0) {\n      exit = 1;\n    }\n  };\n  exitCode(data.metadata);\n  return {\n    report: actions(data, config),\n    exitCode: exit\n  };\n};\nconst getRecommendation = function (action, config) {\n  if (action.action === 'install') {\n    const isDev = action.resolves[0].dev;\n    return {\n      cmd: `npm install ${isDev ? '--save-dev ' : ''}${action.module}@${action.target}`,\n      isBreaking: action.isMajor\n    };\n  } else {\n    return {\n      cmd: `npm update ${action.module} --depth ${action.depth}`,\n      isBreaking: false\n    };\n  }\n};\nmodule.exports = report;","map":{"version":3,"names":["report","data","options","defaults","severityThreshold","config","Object","assign","exit","actions","accumulator","critical","high","moderate","low","keys","advisories","length","forEach","action","l","recommendation","getRecommendation","cmd","breaking","isBreaking","resolves","resolution","advisory","id","sevLevel","severity","title","package","module_name","moreInfo","url","path","join","patchedIn","patched_versions","replace","exitCode","metadata","total","vulnerabilities","key","value","isDev","dev","module","target","isMajor","depth","exports"],"sources":["/Users/hkateliev/node_modules/npm/node_modules/npm-audit-report/reporters/parseable.js"],"sourcesContent":["'use strict'\n\nconst report = function (data, options) {\n  const defaults = {\n    severityThreshold: 'info'\n  }\n\n  const config = Object.assign({}, defaults, options)\n\n  let exit = 0\n\n  const actions = function (data, config) {\n    let accumulator = {\n      critical: '',\n      high: '',\n      moderate: '',\n      low: ''\n    }\n\n    if (Object.keys(data.advisories).length !== 0) {\n      data.actions.forEach((action) => {\n        let l = {}\n        // Start with install/update actions\n        if (action.action === 'update' || action.action === 'install') {\n          const recommendation = getRecommendation(action, config)\n          l.recommendation = recommendation.cmd\n          l.breaking = recommendation.isBreaking ? 'Y' : 'N'\n\n          action.resolves.forEach((resolution) => {\n            const advisory = data.advisories[resolution.id]\n\n            l.sevLevel = advisory.severity\n            l.severity = advisory.title\n            l.package = advisory.module_name\n            l.moreInfo = advisory.url || `https://www.npmjs.com/advisories/${advisory.id}`\n            l.path = resolution.path\n\n            accumulator[advisory.severity] += [action.action, l.package, l.sevLevel, l.recommendation, l.severity, l.moreInfo, l.path, l.breaking]\n              .join('\\t') + '\\n'\n          }) // forEach resolves\n        }\n\n        if (action.action === 'review') {\n          action.resolves.forEach((resolution) => {\n            const advisory = data.advisories[resolution.id]\n\n            l.sevLevel = advisory.severity\n            l.severity = advisory.title\n            l.package = advisory.module_name\n            l.moreInfo = advisory.url || `https://www.npmjs.com/advisories/${advisory.id}`\n            l.patchedIn = advisory.patched_versions.replace(' ', '') === '<0.0.0' ? 'No patch available' : advisory.patched_versions\n            l.path = resolution.path\n\n            accumulator[advisory.severity] += [action.action, l.package, l.sevLevel, l.patchedIn, l.severity, l.moreInfo, l.path].join('\\t') + '\\n'\n          }) // forEach resolves\n        } // is review\n      }) // forEach actions\n    }\n    return accumulator['critical'] + accumulator['high'] + accumulator['moderate'] + accumulator['low']\n  }\n\n  const exitCode = function (metadata) {\n    let total = 0\n    const keys = Object.keys(metadata.vulnerabilities)\n    for (let key of keys) {\n      const value = metadata.vulnerabilities[key]\n      total = total + value\n    }\n\n    if (total > 0) {\n      exit = 1\n    }\n  }\n\n  exitCode(data.metadata)\n\n  return {\n    report: actions(data, config),\n    exitCode: exit\n  }\n}\n\nconst getRecommendation = function (action, config) {\n  if (action.action === 'install') {\n    const isDev = action.resolves[0].dev\n\n    return {\n      cmd: `npm install ${isDev ? '--save-dev ' : ''}${action.module}@${action.target}`,\n      isBreaking: action.isMajor\n    }\n  } else {\n    return {\n      cmd: `npm update ${action.module} --depth ${action.depth}`,\n      isBreaking: false\n    }\n  }\n}\n\nmodule.exports = report\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}