{"ast":null,"code":"'use strict';\n\nexports = module.exports = lifecycle;\nexports.makeEnv = makeEnv;\nexports._incorrectWorkingDirectory = _incorrectWorkingDirectory;\n\n// for testing\nconst platform = process.env.__TESTING_FAKE_PLATFORM__ || process.platform;\nconst isWindows = platform === 'win32';\nconst spawn = require('./lib/spawn');\nconst path = require('path');\nconst Stream = require('stream').Stream;\nconst fs = require('graceful-fs');\nconst chain = require('slide').chain;\nconst uidNumber = require('uid-number');\nconst umask = require('umask');\nconst which = require('which');\nconst byline = require('byline');\nconst resolveFrom = require('resolve-from');\nconst DEFAULT_NODE_GYP_PATH = resolveFrom(__dirname, 'node-gyp/bin/node-gyp');\nconst hookStatCache = new Map();\nlet PATH = isWindows ? 'Path' : 'PATH';\nexports._pathEnvName = PATH;\nconst delimiter = path.delimiter;\n\n// windows calls its path 'Path' usually, but this is not guaranteed.\n// merge them all together in the order they appear in the object.\nconst mergePath = env => Object.keys(env).filter(p => /^path$/i.test(p) && env[p]).map(p => env[p].split(delimiter)).reduce((set, p) => set.concat(p.filter(p => !set.includes(p))), []).join(delimiter);\nexports._mergePath = mergePath;\nconst setPathEnv = (env, path) => {\n  // first ensure that the canonical value is set.\n  env[PATH] = path;\n  // also set any other case values, because windows.\n  Object.keys(env).filter(p => p !== PATH && /^path$/i.test(p)).forEach(p => {\n    env[p] = path;\n  });\n};\nexports._setPathEnv = setPathEnv;\nfunction logid(pkg, stage) {\n  return pkg._id + '~' + stage + ':';\n}\nfunction hookStat(dir, stage, cb) {\n  const hook = path.join(dir, '.hooks', stage);\n  const cachedStatError = hookStatCache.get(hook);\n  if (cachedStatError === undefined) {\n    return fs.stat(hook, function (statError) {\n      hookStatCache.set(hook, statError);\n      cb(statError);\n    });\n  }\n  return setImmediate(() => cb(cachedStatError));\n}\nfunction lifecycle(pkg, stage, wd, opts) {\n  return new Promise((resolve, reject) => {\n    while (pkg && pkg._data) pkg = pkg._data;\n    if (!pkg) return reject(new Error('Invalid package data'));\n    opts.log.info('lifecycle', logid(pkg, stage), pkg._id);\n    if (!pkg.scripts) pkg.scripts = {};\n    if (stage === 'prepublish' && opts.ignorePrepublish) {\n      opts.log.info('lifecycle', logid(pkg, stage), 'ignored because ignore-prepublish is set to true', pkg._id);\n      delete pkg.scripts.prepublish;\n    }\n    hookStat(opts.dir, stage, function (statError) {\n      // makeEnv is a slow operation. This guard clause prevents makeEnv being called\n      // and avoids a ton of unnecessary work, and results in a major perf boost.\n      if (!pkg.scripts[stage] && statError) return resolve();\n      validWd(wd || path.resolve(opts.dir, pkg.name), function (er, wd) {\n        if (er) return reject(er);\n        if ((wd.indexOf(opts.dir) !== 0 || _incorrectWorkingDirectory(wd, pkg)) && !opts.unsafePerm && pkg.scripts[stage]) {\n          opts.log.warn('lifecycle', logid(pkg, stage), 'cannot run in wd', pkg._id, pkg.scripts[stage], `(wd=${wd})`);\n          return resolve();\n        }\n\n        // set the env variables, then run scripts as a child process.\n        var env = makeEnv(pkg, opts);\n        env.npm_lifecycle_event = stage;\n        env.npm_node_execpath = env.NODE = env.NODE || process.execPath;\n        env.npm_execpath = require.main.filename;\n        env.INIT_CWD = process.cwd();\n        env.npm_config_node_gyp = env.npm_config_node_gyp || DEFAULT_NODE_GYP_PATH;\n\n        // 'nobody' typically doesn't have permission to write to /tmp\n        // even if it's never used, sh freaks out.\n        if (!opts.unsafePerm) env.TMPDIR = wd;\n        lifecycle_(pkg, stage, wd, opts, env, er => {\n          if (er) return reject(er);\n          return resolve();\n        });\n      });\n    });\n  });\n}\nfunction _incorrectWorkingDirectory(wd, pkg) {\n  return wd.lastIndexOf(pkg.name) !== wd.length - pkg.name.length;\n}\nfunction lifecycle_(pkg, stage, wd, opts, env, cb) {\n  var pathArr = [];\n  var p = wd.split(/[\\\\/]node_modules[\\\\/]/);\n  var acc = path.resolve(p.shift());\n  p.forEach(function (pp) {\n    pathArr.unshift(path.join(acc, 'node_modules', '.bin'));\n    acc = path.join(acc, 'node_modules', pp);\n  });\n  pathArr.unshift(path.join(acc, 'node_modules', '.bin'));\n\n  // we also unshift the bundled node-gyp-bin folder so that\n  // the bundled one will be used for installing things.\n  pathArr.unshift(path.join(__dirname, 'node-gyp-bin'));\n  if (shouldPrependCurrentNodeDirToPATH(opts)) {\n    // prefer current node interpreter in child scripts\n    pathArr.push(path.dirname(process.execPath));\n  }\n  const existingPath = mergePath(env);\n  if (existingPath) pathArr.push(existingPath);\n  const envPath = pathArr.join(isWindows ? ';' : ':');\n  setPathEnv(env, envPath);\n  var packageLifecycle = pkg.scripts && pkg.scripts.hasOwnProperty(stage);\n  if (opts.ignoreScripts) {\n    opts.log.info('lifecycle', logid(pkg, stage), 'ignored because ignore-scripts is set to true', pkg._id);\n    packageLifecycle = false;\n  } else if (packageLifecycle) {\n    // define this here so it's available to all scripts.\n    env.npm_lifecycle_script = pkg.scripts[stage];\n  } else {\n    opts.log.silly('lifecycle', logid(pkg, stage), 'no script for ' + stage + ', continuing');\n  }\n  function done(er) {\n    if (er) {\n      if (opts.force) {\n        opts.log.info('lifecycle', logid(pkg, stage), 'forced, continuing', er);\n        er = null;\n      } else if (opts.failOk) {\n        opts.log.warn('lifecycle', logid(pkg, stage), 'continuing anyway', er.message);\n        er = null;\n      }\n    }\n    cb(er);\n  }\n  chain([packageLifecycle && [runPackageLifecycle, pkg, stage, env, wd, opts], [runHookLifecycle, pkg, stage, env, wd, opts]], done);\n}\nfunction shouldPrependCurrentNodeDirToPATH(opts) {\n  const cfgsetting = opts.scriptsPrependNodePath;\n  if (cfgsetting === false) return false;\n  if (cfgsetting === true) return true;\n  var isDifferentNodeInPath;\n  var foundExecPath;\n  try {\n    foundExecPath = which.sync(path.basename(process.execPath), {\n      pathExt: isWindows ? ';' : ':'\n    });\n    // Apply `fs.realpath()` here to avoid false positives when `node` is a symlinked executable.\n    isDifferentNodeInPath = fs.realpathSync(process.execPath).toUpperCase() !== fs.realpathSync(foundExecPath).toUpperCase();\n  } catch (e) {\n    isDifferentNodeInPath = true;\n  }\n  if (cfgsetting === 'warn-only') {\n    if (isDifferentNodeInPath && !shouldPrependCurrentNodeDirToPATH.hasWarned) {\n      if (foundExecPath) {\n        opts.log.warn('lifecycle', 'The node binary used for scripts is', foundExecPath, 'but npm is using', process.execPath, 'itself. Use the `--scripts-prepend-node-path` option to include the path for the node binary npm was executed with.');\n      } else {\n        opts.log.warn('lifecycle', 'npm is using', process.execPath, 'but there is no node binary in the current PATH. Use the `--scripts-prepend-node-path` option to include the path for the node binary npm was executed with.');\n      }\n      shouldPrependCurrentNodeDirToPATH.hasWarned = true;\n    }\n    return false;\n  }\n  return isDifferentNodeInPath;\n}\nfunction validWd(d, cb) {\n  fs.stat(d, function (er, st) {\n    if (er || !st.isDirectory()) {\n      var p = path.dirname(d);\n      if (p === d) {\n        return cb(new Error('Could not find suitable wd'));\n      }\n      return validWd(p, cb);\n    }\n    return cb(null, d);\n  });\n}\nfunction runPackageLifecycle(pkg, stage, env, wd, opts, cb) {\n  // run package lifecycle scripts in the package root, or the nearest parent.\n  var cmd = env.npm_lifecycle_script;\n  var note = '\\n> ' + pkg._id + ' ' + stage + ' ' + wd + '\\n> ' + cmd + '\\n';\n  runCmd(note, cmd, pkg, env, stage, wd, opts, cb);\n}\nvar running = false;\nvar queue = [];\nfunction dequeue() {\n  running = false;\n  if (queue.length) {\n    var r = queue.shift();\n    runCmd.apply(null, r);\n  }\n}\nfunction runCmd(note, cmd, pkg, env, stage, wd, opts, cb) {\n  if (running) {\n    queue.push([note, cmd, pkg, env, stage, wd, opts, cb]);\n    return;\n  }\n  running = true;\n  opts.log.pause();\n  var unsafe = opts.unsafePerm;\n  var user = unsafe ? null : opts.user;\n  var group = unsafe ? null : opts.group;\n  if (opts.log.level !== 'silent') {\n    opts.log.clearProgress();\n    console.log(note);\n    opts.log.showProgress();\n  }\n  opts.log.verbose('lifecycle', logid(pkg, stage), 'unsafe-perm in lifecycle', unsafe);\n  if (isWindows) {\n    unsafe = true;\n  }\n  if (unsafe) {\n    runCmd_(cmd, pkg, env, wd, opts, stage, unsafe, 0, 0, cb);\n  } else {\n    uidNumber(user, group, function (er, uid, gid) {\n      if (er) {\n        er.code = 'EUIDLOOKUP';\n        opts.log.resume();\n        process.nextTick(dequeue);\n        return cb(er);\n      }\n      runCmd_(cmd, pkg, env, wd, opts, stage, unsafe, uid, gid, cb);\n    });\n  }\n}\nconst getSpawnArgs = _ref => {\n  let {\n    cmd,\n    wd,\n    opts,\n    uid,\n    gid,\n    unsafe,\n    env\n  } = _ref;\n  const conf = {\n    cwd: wd,\n    env: env,\n    stdio: opts.stdio || [0, 1, 2]\n  };\n  if (!unsafe) {\n    conf.uid = uid ^ 0;\n    conf.gid = gid ^ 0;\n  }\n  const customShell = opts.scriptShell;\n  let sh = 'sh';\n  let shFlag = '-c';\n  if (customShell) {\n    sh = customShell;\n  } else if (isWindows || opts._TESTING_FAKE_WINDOWS_) {\n    sh = process.env.comspec || 'cmd';\n    // '/d /s /c' is used only for cmd.exe.\n    if (/^(?:.*\\\\)?cmd(?:\\.exe)?$/i.test(sh)) {\n      shFlag = '/d /s /c';\n      conf.windowsVerbatimArguments = true;\n    }\n  }\n  return [sh, [shFlag, cmd], conf];\n};\nexports._getSpawnArgs = getSpawnArgs;\nfunction runCmd_(cmd, pkg, env, wd, opts, stage, unsafe, uid, gid, cb_) {\n  function cb(er) {\n    cb_.apply(null, arguments);\n    opts.log.resume();\n    process.nextTick(dequeue);\n  }\n  const [sh, args, conf] = getSpawnArgs({\n    cmd,\n    wd,\n    opts,\n    uid,\n    gid,\n    unsafe,\n    env\n  });\n  opts.log.verbose('lifecycle', logid(pkg, stage), 'PATH:', env[PATH]);\n  opts.log.verbose('lifecycle', logid(pkg, stage), 'CWD:', wd);\n  opts.log.silly('lifecycle', logid(pkg, stage), 'Args:', args);\n  var proc = spawn(sh, args, conf, opts.log);\n  proc.on('error', procError);\n  proc.on('close', function (code, signal) {\n    opts.log.silly('lifecycle', logid(pkg, stage), 'Returned: code:', code, ' signal:', signal);\n    if (signal) {\n      process.kill(process.pid, signal);\n    } else if (code) {\n      var er = new Error('Exit status ' + code);\n      er.errno = code;\n    }\n    procError(er);\n  });\n  byline(proc.stdout).on('data', function (data) {\n    opts.log.verbose('lifecycle', logid(pkg, stage), 'stdout', data.toString());\n  });\n  byline(proc.stderr).on('data', function (data) {\n    opts.log.verbose('lifecycle', logid(pkg, stage), 'stderr', data.toString());\n  });\n  process.once('SIGTERM', procKill);\n  process.once('SIGINT', procInterupt);\n  function procError(er) {\n    if (er) {\n      opts.log.info('lifecycle', logid(pkg, stage), 'Failed to exec ' + stage + ' script');\n      er.message = pkg._id + ' ' + stage + ': `' + cmd + '`\\n' + er.message;\n      if (er.code !== 'EPERM') {\n        er.code = 'ELIFECYCLE';\n      }\n      fs.stat(opts.dir, function (statError, d) {\n        if (statError && statError.code === 'ENOENT' && opts.dir.split(path.sep).slice(-1)[0] === 'node_modules') {\n          opts.log.warn('', 'Local package.json exists, but node_modules missing, did you mean to install?');\n        }\n      });\n      er.pkgid = pkg._id;\n      er.stage = stage;\n      er.script = cmd;\n      er.pkgname = pkg.name;\n    }\n    process.removeListener('SIGTERM', procKill);\n    process.removeListener('SIGTERM', procInterupt);\n    process.removeListener('SIGINT', procKill);\n    process.removeListener('SIGINT', procInterupt);\n    return cb(er);\n  }\n  function procKill() {\n    proc.kill();\n  }\n  function procInterupt() {\n    proc.kill('SIGINT');\n    proc.on('exit', function () {\n      process.exit();\n    });\n    process.once('SIGINT', procKill);\n  }\n}\nfunction runHookLifecycle(pkg, stage, env, wd, opts, cb) {\n  hookStat(opts.dir, stage, function (er) {\n    if (er) return cb();\n    var cmd = path.join(opts.dir, '.hooks', stage);\n    var note = '\\n> ' + pkg._id + ' ' + stage + ' ' + wd + '\\n> ' + cmd;\n    runCmd(note, cmd, pkg, env, stage, wd, opts, cb);\n  });\n}\nfunction makeEnv(data, opts, prefix, env) {\n  prefix = prefix || 'npm_package_';\n  if (!env) {\n    env = {};\n    for (var i in process.env) {\n      if (!i.match(/^npm_/)) {\n        env[i] = process.env[i];\n      }\n    }\n\n    // express and others respect the NODE_ENV value.\n    if (opts.production) env.NODE_ENV = 'production';\n  } else if (!data.hasOwnProperty('_lifecycleEnv')) {\n    Object.defineProperty(data, '_lifecycleEnv', {\n      value: env,\n      enumerable: false\n    });\n  }\n  if (opts.nodeOptions) env.NODE_OPTIONS = opts.nodeOptions;\n  for (i in data) {\n    if (i.charAt(0) !== '_') {\n      var envKey = (prefix + i).replace(/[^a-zA-Z0-9_]/g, '_');\n      if (i === 'readme') {\n        continue;\n      }\n      if (data[i] && typeof data[i] === 'object') {\n        try {\n          // quick and dirty detection for cyclical structures\n          JSON.stringify(data[i]);\n          makeEnv(data[i], opts, envKey + '_', env);\n        } catch (ex) {\n          // usually these are package objects.\n          // just get the path and basic details.\n          var d = data[i];\n          makeEnv({\n            name: d.name,\n            version: d.version,\n            path: d.path\n          }, opts, envKey + '_', env);\n        }\n      } else {\n        env[envKey] = String(data[i]);\n        env[envKey] = env[envKey].indexOf('\\n') !== -1 ? JSON.stringify(env[envKey]) : env[envKey];\n      }\n    }\n  }\n  if (prefix !== 'npm_package_') return env;\n  prefix = 'npm_config_';\n  var pkgConfig = {};\n  var pkgVerConfig = {};\n  var namePref = data.name + ':';\n  var verPref = data.name + '@' + data.version + ':';\n  Object.keys(opts.config).forEach(function (i) {\n    // in some rare cases (e.g. working with nerf darts), there are segmented\n    // \"private\" (underscore-prefixed) config names -- don't export\n    if (i.charAt(0) === '_' && i.indexOf('_' + namePref) !== 0 || i.match(/:_/)) {\n      return;\n    }\n    var value = opts.config[i];\n    if (value instanceof Stream || Array.isArray(value) || typeof value === 'function') return;\n    if (i.match(/umask/)) value = umask.toString(value);\n    if (!value) value = '';else if (typeof value === 'number') value = '' + value;else if (typeof value !== 'string') value = JSON.stringify(value);\n    if (typeof value !== 'string') {\n      return;\n    }\n    value = value.indexOf('\\n') !== -1 ? JSON.stringify(value) : value;\n    i = i.replace(/^_+/, '');\n    var k;\n    if (i.indexOf(namePref) === 0) {\n      k = i.substr(namePref.length).replace(/[^a-zA-Z0-9_]/g, '_');\n      pkgConfig[k] = value;\n    } else if (i.indexOf(verPref) === 0) {\n      k = i.substr(verPref.length).replace(/[^a-zA-Z0-9_]/g, '_');\n      pkgVerConfig[k] = value;\n    }\n    var envKey = (prefix + i).replace(/[^a-zA-Z0-9_]/g, '_');\n    env[envKey] = value;\n  });\n  prefix = 'npm_package_config_';\n  [pkgConfig, pkgVerConfig].forEach(function (conf) {\n    for (var i in conf) {\n      var envKey = prefix + i;\n      env[envKey] = conf[i];\n    }\n  });\n  return env;\n}","map":{"version":3,"names":["exports","module","lifecycle","makeEnv","_incorrectWorkingDirectory","platform","process","env","__TESTING_FAKE_PLATFORM__","isWindows","spawn","require","path","Stream","fs","chain","uidNumber","umask","which","byline","resolveFrom","DEFAULT_NODE_GYP_PATH","__dirname","hookStatCache","Map","PATH","_pathEnvName","delimiter","mergePath","Object","keys","filter","p","test","map","split","reduce","set","concat","includes","join","_mergePath","setPathEnv","forEach","_setPathEnv","logid","pkg","stage","_id","hookStat","dir","cb","hook","cachedStatError","get","undefined","stat","statError","setImmediate","wd","opts","Promise","resolve","reject","_data","Error","log","info","scripts","ignorePrepublish","prepublish","validWd","name","er","indexOf","unsafePerm","warn","npm_lifecycle_event","npm_node_execpath","NODE","execPath","npm_execpath","main","filename","INIT_CWD","cwd","npm_config_node_gyp","TMPDIR","lifecycle_","lastIndexOf","length","pathArr","acc","shift","pp","unshift","shouldPrependCurrentNodeDirToPATH","push","dirname","existingPath","envPath","packageLifecycle","hasOwnProperty","ignoreScripts","npm_lifecycle_script","silly","done","force","failOk","message","runPackageLifecycle","runHookLifecycle","cfgsetting","scriptsPrependNodePath","isDifferentNodeInPath","foundExecPath","sync","basename","pathExt","realpathSync","toUpperCase","e","hasWarned","d","st","isDirectory","cmd","note","runCmd","running","queue","dequeue","r","apply","pause","unsafe","user","group","level","clearProgress","console","showProgress","verbose","runCmd_","uid","gid","code","resume","nextTick","getSpawnArgs","_ref","conf","stdio","customShell","scriptShell","sh","shFlag","_TESTING_FAKE_WINDOWS_","comspec","windowsVerbatimArguments","_getSpawnArgs","cb_","arguments","args","proc","on","procError","signal","kill","pid","errno","stdout","data","toString","stderr","once","procKill","procInterupt","sep","slice","pkgid","script","pkgname","removeListener","exit","prefix","i","match","production","NODE_ENV","defineProperty","value","enumerable","nodeOptions","NODE_OPTIONS","charAt","envKey","replace","JSON","stringify","ex","version","String","pkgConfig","pkgVerConfig","namePref","verPref","config","Array","isArray","k","substr"],"sources":["/Users/hkateliev/node_modules/npm/node_modules/npm-lifecycle/index.js"],"sourcesContent":["'use strict'\n\nexports = module.exports = lifecycle\nexports.makeEnv = makeEnv\nexports._incorrectWorkingDirectory = _incorrectWorkingDirectory\n\n// for testing\nconst platform = process.env.__TESTING_FAKE_PLATFORM__ || process.platform\nconst isWindows = platform === 'win32'\nconst spawn = require('./lib/spawn')\nconst path = require('path')\nconst Stream = require('stream').Stream\nconst fs = require('graceful-fs')\nconst chain = require('slide').chain\nconst uidNumber = require('uid-number')\nconst umask = require('umask')\nconst which = require('which')\nconst byline = require('byline')\nconst resolveFrom = require('resolve-from')\n\nconst DEFAULT_NODE_GYP_PATH = resolveFrom(__dirname, 'node-gyp/bin/node-gyp')\nconst hookStatCache = new Map()\n\nlet PATH = isWindows ? 'Path' : 'PATH'\nexports._pathEnvName = PATH\nconst delimiter = path.delimiter\n\n// windows calls its path 'Path' usually, but this is not guaranteed.\n// merge them all together in the order they appear in the object.\nconst mergePath = env =>\n  Object.keys(env).filter(p => /^path$/i.test(p) && env[p])\n    .map(p => env[p].split(delimiter))\n    .reduce((set, p) => set.concat(p.filter(p => !set.includes(p))), [])\n    .join(delimiter)\nexports._mergePath = mergePath\n\nconst setPathEnv = (env, path) => {\n  // first ensure that the canonical value is set.\n  env[PATH] = path\n  // also set any other case values, because windows.\n  Object.keys(env)\n    .filter(p => p !== PATH && /^path$/i.test(p))\n    .forEach(p => { env[p] = path })\n}\nexports._setPathEnv = setPathEnv\n\nfunction logid (pkg, stage) {\n  return pkg._id + '~' + stage + ':'\n}\n\nfunction hookStat (dir, stage, cb) {\n  const hook = path.join(dir, '.hooks', stage)\n  const cachedStatError = hookStatCache.get(hook)\n\n  if (cachedStatError === undefined) {\n    return fs.stat(hook, function (statError) {\n      hookStatCache.set(hook, statError)\n      cb(statError)\n    })\n  }\n\n  return setImmediate(() => cb(cachedStatError))\n}\n\nfunction lifecycle (pkg, stage, wd, opts) {\n  return new Promise((resolve, reject) => {\n    while (pkg && pkg._data) pkg = pkg._data\n    if (!pkg) return reject(new Error('Invalid package data'))\n\n    opts.log.info('lifecycle', logid(pkg, stage), pkg._id)\n    if (!pkg.scripts) pkg.scripts = {}\n\n    if (stage === 'prepublish' && opts.ignorePrepublish) {\n      opts.log.info('lifecycle', logid(pkg, stage), 'ignored because ignore-prepublish is set to true', pkg._id)\n      delete pkg.scripts.prepublish\n    }\n\n    hookStat(opts.dir, stage, function (statError) {\n      // makeEnv is a slow operation. This guard clause prevents makeEnv being called\n      // and avoids a ton of unnecessary work, and results in a major perf boost.\n      if (!pkg.scripts[stage] && statError) return resolve()\n\n      validWd(wd || path.resolve(opts.dir, pkg.name), function (er, wd) {\n        if (er) return reject(er)\n\n        if ((wd.indexOf(opts.dir) !== 0 || _incorrectWorkingDirectory(wd, pkg)) &&\n            !opts.unsafePerm && pkg.scripts[stage]) {\n          opts.log.warn('lifecycle', logid(pkg, stage), 'cannot run in wd', pkg._id, pkg.scripts[stage], `(wd=${wd})`)\n          return resolve()\n        }\n\n        // set the env variables, then run scripts as a child process.\n        var env = makeEnv(pkg, opts)\n        env.npm_lifecycle_event = stage\n        env.npm_node_execpath = env.NODE = env.NODE || process.execPath\n        env.npm_execpath = require.main.filename\n        env.INIT_CWD = process.cwd()\n        env.npm_config_node_gyp = env.npm_config_node_gyp || DEFAULT_NODE_GYP_PATH\n\n        // 'nobody' typically doesn't have permission to write to /tmp\n        // even if it's never used, sh freaks out.\n        if (!opts.unsafePerm) env.TMPDIR = wd\n\n        lifecycle_(pkg, stage, wd, opts, env, (er) => {\n          if (er) return reject(er)\n          return resolve()\n        })\n      })\n    })\n  })\n}\n\nfunction _incorrectWorkingDirectory (wd, pkg) {\n  return wd.lastIndexOf(pkg.name) !== wd.length - pkg.name.length\n}\n\nfunction lifecycle_ (pkg, stage, wd, opts, env, cb) {\n  var pathArr = []\n  var p = wd.split(/[\\\\/]node_modules[\\\\/]/)\n  var acc = path.resolve(p.shift())\n\n  p.forEach(function (pp) {\n    pathArr.unshift(path.join(acc, 'node_modules', '.bin'))\n    acc = path.join(acc, 'node_modules', pp)\n  })\n  pathArr.unshift(path.join(acc, 'node_modules', '.bin'))\n\n  // we also unshift the bundled node-gyp-bin folder so that\n  // the bundled one will be used for installing things.\n  pathArr.unshift(path.join(__dirname, 'node-gyp-bin'))\n\n  if (shouldPrependCurrentNodeDirToPATH(opts)) {\n    // prefer current node interpreter in child scripts\n    pathArr.push(path.dirname(process.execPath))\n  }\n\n  const existingPath = mergePath(env)\n  if (existingPath) pathArr.push(existingPath)\n  const envPath = pathArr.join(isWindows ? ';' : ':')\n  setPathEnv(env, envPath)\n\n  var packageLifecycle = pkg.scripts && pkg.scripts.hasOwnProperty(stage)\n\n  if (opts.ignoreScripts) {\n    opts.log.info('lifecycle', logid(pkg, stage), 'ignored because ignore-scripts is set to true', pkg._id)\n    packageLifecycle = false\n  } else if (packageLifecycle) {\n    // define this here so it's available to all scripts.\n    env.npm_lifecycle_script = pkg.scripts[stage]\n  } else {\n    opts.log.silly('lifecycle', logid(pkg, stage), 'no script for ' + stage + ', continuing')\n  }\n\n  function done (er) {\n    if (er) {\n      if (opts.force) {\n        opts.log.info('lifecycle', logid(pkg, stage), 'forced, continuing', er)\n        er = null\n      } else if (opts.failOk) {\n        opts.log.warn('lifecycle', logid(pkg, stage), 'continuing anyway', er.message)\n        er = null\n      }\n    }\n    cb(er)\n  }\n\n  chain(\n    [\n      packageLifecycle && [runPackageLifecycle, pkg, stage, env, wd, opts],\n      [runHookLifecycle, pkg, stage, env, wd, opts]\n    ],\n    done\n  )\n}\n\nfunction shouldPrependCurrentNodeDirToPATH (opts) {\n  const cfgsetting = opts.scriptsPrependNodePath\n  if (cfgsetting === false) return false\n  if (cfgsetting === true) return true\n\n  var isDifferentNodeInPath\n\n  var foundExecPath\n  try {\n    foundExecPath = which.sync(path.basename(process.execPath), { pathExt: isWindows ? ';' : ':' })\n    // Apply `fs.realpath()` here to avoid false positives when `node` is a symlinked executable.\n    isDifferentNodeInPath = fs.realpathSync(process.execPath).toUpperCase() !==\n        fs.realpathSync(foundExecPath).toUpperCase()\n  } catch (e) {\n    isDifferentNodeInPath = true\n  }\n\n  if (cfgsetting === 'warn-only') {\n    if (isDifferentNodeInPath && !shouldPrependCurrentNodeDirToPATH.hasWarned) {\n      if (foundExecPath) {\n        opts.log.warn('lifecycle', 'The node binary used for scripts is', foundExecPath, 'but npm is using', process.execPath, 'itself. Use the `--scripts-prepend-node-path` option to include the path for the node binary npm was executed with.')\n      } else {\n        opts.log.warn('lifecycle', 'npm is using', process.execPath, 'but there is no node binary in the current PATH. Use the `--scripts-prepend-node-path` option to include the path for the node binary npm was executed with.')\n      }\n      shouldPrependCurrentNodeDirToPATH.hasWarned = true\n    }\n\n    return false\n  }\n\n  return isDifferentNodeInPath\n}\n\nfunction validWd (d, cb) {\n  fs.stat(d, function (er, st) {\n    if (er || !st.isDirectory()) {\n      var p = path.dirname(d)\n      if (p === d) {\n        return cb(new Error('Could not find suitable wd'))\n      }\n      return validWd(p, cb)\n    }\n    return cb(null, d)\n  })\n}\n\nfunction runPackageLifecycle (pkg, stage, env, wd, opts, cb) {\n  // run package lifecycle scripts in the package root, or the nearest parent.\n  var cmd = env.npm_lifecycle_script\n\n  var note = '\\n> ' + pkg._id + ' ' + stage + ' ' + wd +\n             '\\n> ' + cmd + '\\n'\n  runCmd(note, cmd, pkg, env, stage, wd, opts, cb)\n}\n\nvar running = false\nvar queue = []\nfunction dequeue () {\n  running = false\n  if (queue.length) {\n    var r = queue.shift()\n    runCmd.apply(null, r)\n  }\n}\n\nfunction runCmd (note, cmd, pkg, env, stage, wd, opts, cb) {\n  if (running) {\n    queue.push([note, cmd, pkg, env, stage, wd, opts, cb])\n    return\n  }\n\n  running = true\n  opts.log.pause()\n  var unsafe = opts.unsafePerm\n  var user = unsafe ? null : opts.user\n  var group = unsafe ? null : opts.group\n\n  if (opts.log.level !== 'silent') {\n    opts.log.clearProgress()\n    console.log(note)\n    opts.log.showProgress()\n  }\n  opts.log.verbose('lifecycle', logid(pkg, stage), 'unsafe-perm in lifecycle', unsafe)\n\n  if (isWindows) {\n    unsafe = true\n  }\n\n  if (unsafe) {\n    runCmd_(cmd, pkg, env, wd, opts, stage, unsafe, 0, 0, cb)\n  } else {\n    uidNumber(user, group, function (er, uid, gid) {\n      if (er) {\n        er.code = 'EUIDLOOKUP'\n        opts.log.resume()\n        process.nextTick(dequeue)\n        return cb(er)\n      }\n      runCmd_(cmd, pkg, env, wd, opts, stage, unsafe, uid, gid, cb)\n    })\n  }\n}\n\nconst getSpawnArgs = ({ cmd, wd, opts, uid, gid, unsafe, env }) => {\n  const conf = {\n    cwd: wd,\n    env: env,\n    stdio: opts.stdio || [ 0, 1, 2 ]\n  }\n\n  if (!unsafe) {\n    conf.uid = uid ^ 0\n    conf.gid = gid ^ 0\n  }\n\n  const customShell = opts.scriptShell\n\n  let sh = 'sh'\n  let shFlag = '-c'\n  if (customShell) {\n    sh = customShell\n  } else if (isWindows || opts._TESTING_FAKE_WINDOWS_) {\n    sh = process.env.comspec || 'cmd'\n    // '/d /s /c' is used only for cmd.exe.\n    if (/^(?:.*\\\\)?cmd(?:\\.exe)?$/i.test(sh)) {\n      shFlag = '/d /s /c'\n      conf.windowsVerbatimArguments = true\n    }\n  }\n\n  return [sh, [shFlag, cmd], conf]\n}\n\nexports._getSpawnArgs = getSpawnArgs\n\nfunction runCmd_ (cmd, pkg, env, wd, opts, stage, unsafe, uid, gid, cb_) {\n  function cb (er) {\n    cb_.apply(null, arguments)\n    opts.log.resume()\n    process.nextTick(dequeue)\n  }\n\n  const [sh, args, conf] = getSpawnArgs({ cmd, wd, opts, uid, gid, unsafe, env })\n\n  opts.log.verbose('lifecycle', logid(pkg, stage), 'PATH:', env[PATH])\n  opts.log.verbose('lifecycle', logid(pkg, stage), 'CWD:', wd)\n  opts.log.silly('lifecycle', logid(pkg, stage), 'Args:', args)\n\n  var proc = spawn(sh, args, conf, opts.log)\n\n  proc.on('error', procError)\n  proc.on('close', function (code, signal) {\n    opts.log.silly('lifecycle', logid(pkg, stage), 'Returned: code:', code, ' signal:', signal)\n    if (signal) {\n      process.kill(process.pid, signal)\n    } else if (code) {\n      var er = new Error('Exit status ' + code)\n      er.errno = code\n    }\n    procError(er)\n  })\n  byline(proc.stdout).on('data', function (data) {\n    opts.log.verbose('lifecycle', logid(pkg, stage), 'stdout', data.toString())\n  })\n  byline(proc.stderr).on('data', function (data) {\n    opts.log.verbose('lifecycle', logid(pkg, stage), 'stderr', data.toString())\n  })\n  process.once('SIGTERM', procKill)\n  process.once('SIGINT', procInterupt)\n\n  function procError (er) {\n    if (er) {\n      opts.log.info('lifecycle', logid(pkg, stage), 'Failed to exec ' + stage + ' script')\n      er.message = pkg._id + ' ' + stage + ': `' + cmd + '`\\n' +\n                   er.message\n      if (er.code !== 'EPERM') {\n        er.code = 'ELIFECYCLE'\n      }\n      fs.stat(opts.dir, function (statError, d) {\n        if (statError && statError.code === 'ENOENT' && opts.dir.split(path.sep).slice(-1)[0] === 'node_modules') {\n          opts.log.warn('', 'Local package.json exists, but node_modules missing, did you mean to install?')\n        }\n      })\n      er.pkgid = pkg._id\n      er.stage = stage\n      er.script = cmd\n      er.pkgname = pkg.name\n    }\n    process.removeListener('SIGTERM', procKill)\n    process.removeListener('SIGTERM', procInterupt)\n    process.removeListener('SIGINT', procKill)\n    process.removeListener('SIGINT', procInterupt)\n    return cb(er)\n  }\n  function procKill () {\n    proc.kill()\n  }\n  function procInterupt () {\n    proc.kill('SIGINT')\n    proc.on('exit', function () {\n      process.exit()\n    })\n    process.once('SIGINT', procKill)\n  }\n}\n\nfunction runHookLifecycle (pkg, stage, env, wd, opts, cb) {\n  hookStat(opts.dir, stage, function (er) {\n    if (er) return cb()\n    var cmd = path.join(opts.dir, '.hooks', stage)\n    var note = '\\n> ' + pkg._id + ' ' + stage + ' ' + wd +\n               '\\n> ' + cmd\n    runCmd(note, cmd, pkg, env, stage, wd, opts, cb)\n  })\n}\n\nfunction makeEnv (data, opts, prefix, env) {\n  prefix = prefix || 'npm_package_'\n  if (!env) {\n    env = {}\n    for (var i in process.env) {\n      if (!i.match(/^npm_/)) {\n        env[i] = process.env[i]\n      }\n    }\n\n    // express and others respect the NODE_ENV value.\n    if (opts.production) env.NODE_ENV = 'production'\n  } else if (!data.hasOwnProperty('_lifecycleEnv')) {\n    Object.defineProperty(data, '_lifecycleEnv',\n      {\n        value: env,\n        enumerable: false\n      }\n    )\n  }\n\n  if (opts.nodeOptions) env.NODE_OPTIONS = opts.nodeOptions\n\n  for (i in data) {\n    if (i.charAt(0) !== '_') {\n      var envKey = (prefix + i).replace(/[^a-zA-Z0-9_]/g, '_')\n      if (i === 'readme') {\n        continue\n      }\n      if (data[i] && typeof data[i] === 'object') {\n        try {\n          // quick and dirty detection for cyclical structures\n          JSON.stringify(data[i])\n          makeEnv(data[i], opts, envKey + '_', env)\n        } catch (ex) {\n          // usually these are package objects.\n          // just get the path and basic details.\n          var d = data[i]\n          makeEnv(\n            { name: d.name, version: d.version, path: d.path },\n            opts,\n            envKey + '_',\n            env\n          )\n        }\n      } else {\n        env[envKey] = String(data[i])\n        env[envKey] = env[envKey].indexOf('\\n') !== -1\n          ? JSON.stringify(env[envKey])\n          : env[envKey]\n      }\n    }\n  }\n\n  if (prefix !== 'npm_package_') return env\n\n  prefix = 'npm_config_'\n  var pkgConfig = {}\n  var pkgVerConfig = {}\n  var namePref = data.name + ':'\n  var verPref = data.name + '@' + data.version + ':'\n\n  Object.keys(opts.config).forEach(function (i) {\n    // in some rare cases (e.g. working with nerf darts), there are segmented\n    // \"private\" (underscore-prefixed) config names -- don't export\n    if ((i.charAt(0) === '_' && i.indexOf('_' + namePref) !== 0) || i.match(/:_/)) {\n      return\n    }\n    var value = opts.config[i]\n    if (value instanceof Stream || Array.isArray(value) || typeof value === 'function') return\n    if (i.match(/umask/)) value = umask.toString(value)\n\n    if (!value) value = ''\n    else if (typeof value === 'number') value = '' + value\n    else if (typeof value !== 'string') value = JSON.stringify(value)\n\n    if (typeof value !== 'string') {\n      return\n    }\n\n    value = value.indexOf('\\n') !== -1\n      ? JSON.stringify(value)\n      : value\n    i = i.replace(/^_+/, '')\n    var k\n    if (i.indexOf(namePref) === 0) {\n      k = i.substr(namePref.length).replace(/[^a-zA-Z0-9_]/g, '_')\n      pkgConfig[k] = value\n    } else if (i.indexOf(verPref) === 0) {\n      k = i.substr(verPref.length).replace(/[^a-zA-Z0-9_]/g, '_')\n      pkgVerConfig[k] = value\n    }\n    var envKey = (prefix + i).replace(/[^a-zA-Z0-9_]/g, '_')\n    env[envKey] = value\n  })\n\n  prefix = 'npm_package_config_'\n  ;[pkgConfig, pkgVerConfig].forEach(function (conf) {\n    for (var i in conf) {\n      var envKey = (prefix + i)\n      env[envKey] = conf[i]\n    }\n  })\n\n  return env\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}