{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nclass ReceiveBuffer {\n  constructor() {\n    let size = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 4096;\n    this._buffer = Buffer.allocUnsafe(size);\n    this._offset = 0;\n    this._originalSize = size;\n  }\n  get length() {\n    return this._offset;\n  }\n  append(data) {\n    if (!Buffer.isBuffer(data)) {\n      throw new Error('Attempted to append a non-buffer instance to ReceiveBuffer.');\n    }\n    if (this._offset + data.length >= this._buffer.length) {\n      const tmp = this._buffer;\n      this._buffer = Buffer.allocUnsafe(Math.max(this._buffer.length + this._originalSize, this._buffer.length + data.length));\n      tmp.copy(this._buffer);\n    }\n    data.copy(this._buffer, this._offset);\n    return this._offset += data.length;\n  }\n  peek(length) {\n    if (length > this._offset) {\n      throw new Error('Attempted to read beyond the bounds of the managed internal data.');\n    }\n    return this._buffer.slice(0, length);\n  }\n  get(length) {\n    if (length > this._offset) {\n      throw new Error('Attempted to read beyond the bounds of the managed internal data.');\n    }\n    const value = Buffer.allocUnsafe(length);\n    this._buffer.slice(0, length).copy(value);\n    this._buffer.copyWithin(0, length, length + this._offset - length);\n    this._offset -= length;\n    return value;\n  }\n}\nexports.ReceiveBuffer = ReceiveBuffer;","map":{"version":3,"names":["ReceiveBuffer","constructor","size","arguments","length","undefined","_buffer","Buffer","allocUnsafe","_offset","_originalSize","append","data","isBuffer","Error","tmp","Math","max","copy","peek","slice","get","value","copyWithin","exports"],"sources":["../../src/common/receivebuffer.ts"],"sourcesContent":[null],"mappings":";;;;;AAAA,MAAMA,aAAa;EAKjBC,YAAA,EAA+B;IAAA,IAAnBC,IAAA,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAe,IAAI;IAC7B,IAAI,CAACG,OAAO,GAAGC,MAAM,CAACC,WAAW,CAACN,IAAI,CAAC;IACvC,IAAI,CAACO,OAAO,GAAG,CAAC;IAChB,IAAI,CAACC,aAAa,GAAGR,IAAI;EAC3B;EAEA,IAAIE,MAAMA,CAAA;IACR,OAAO,IAAI,CAACK,OAAO;EACrB;EAEAE,MAAMA,CAACC,IAAY;IACjB,IAAI,CAACL,MAAM,CAACM,QAAQ,CAACD,IAAI,CAAC,EAAE;MAC1B,MAAM,IAAIE,KAAK,CACb,6DAA6D,CAC9D;;IAGH,IAAI,IAAI,CAACL,OAAO,GAAGG,IAAI,CAACR,MAAM,IAAI,IAAI,CAACE,OAAO,CAACF,MAAM,EAAE;MACrD,MAAMW,GAAG,GAAG,IAAI,CAACT,OAAO;MACxB,IAAI,CAACA,OAAO,GAAGC,MAAM,CAACC,WAAW,CAC/BQ,IAAI,CAACC,GAAG,CACN,IAAI,CAACX,OAAO,CAACF,MAAM,GAAG,IAAI,CAACM,aAAa,EACxC,IAAI,CAACJ,OAAO,CAACF,MAAM,GAAGQ,IAAI,CAACR,MAAM,CAClC,CACF;MACDW,GAAG,CAACG,IAAI,CAAC,IAAI,CAACZ,OAAO,CAAC;;IAGxBM,IAAI,CAACM,IAAI,CAAC,IAAI,CAACZ,OAAO,EAAE,IAAI,CAACG,OAAO,CAAC;IACrC,OAAQ,IAAI,CAACA,OAAO,IAAIG,IAAI,CAACR,MAAM;EACrC;EAEAe,IAAIA,CAACf,MAAc;IACjB,IAAIA,MAAM,GAAG,IAAI,CAACK,OAAO,EAAE;MACzB,MAAM,IAAIK,KAAK,CACb,mEAAmE,CACpE;;IAEH,OAAO,IAAI,CAACR,OAAO,CAACc,KAAK,CAAC,CAAC,EAAEhB,MAAM,CAAC;EACtC;EAEAiB,GAAGA,CAACjB,MAAc;IAChB,IAAIA,MAAM,GAAG,IAAI,CAACK,OAAO,EAAE;MACzB,MAAM,IAAIK,KAAK,CACb,mEAAmE,CACpE;;IAGH,MAAMQ,KAAK,GAAGf,MAAM,CAACC,WAAW,CAACJ,MAAM,CAAC;IACxC,IAAI,CAACE,OAAO,CAACc,KAAK,CAAC,CAAC,EAAEhB,MAAM,CAAC,CAACc,IAAI,CAACI,KAAK,CAAC;IACzC,IAAI,CAAChB,OAAO,CAACiB,UAAU,CAAC,CAAC,EAAEnB,MAAM,EAAEA,MAAM,GAAG,IAAI,CAACK,OAAO,GAAGL,MAAM,CAAC;IAClE,IAAI,CAACK,OAAO,IAAIL,MAAM;IAEtB,OAAOkB,KAAK;EACd;;AAGOE,OAAA,CAAAxB,aAAA,GAAAA,aAAA"},"metadata":{},"sourceType":"script","externalDependencies":[]}