{"ast":null,"code":"var CC = require('config-chain').ConfigChain;\nvar inherits = require('inherits');\nvar configDefs = require('./defaults.js');\nvar types = configDefs.types;\nvar once = require('once');\nvar fs = require('fs');\nvar path = require('path');\nvar nopt = require('nopt');\nvar ini = require('ini');\nvar Umask = configDefs.Umask;\nvar mkdirp = require('gentle-fs').mkdir;\nvar umask = require('../utils/umask');\nvar isWindows = require('../utils/is-windows.js');\nexports.load = load;\nexports.Conf = Conf;\nexports.loaded = false;\nexports.rootConf = null;\nexports.usingBuiltin = false;\nexports.defs = configDefs;\nObject.defineProperty(exports, 'defaults', {\n  get: function () {\n    return configDefs.defaults;\n  },\n  enumerable: true\n});\nObject.defineProperty(exports, 'types', {\n  get: function () {\n    return configDefs.types;\n  },\n  enumerable: true\n});\nexports.validate = validate;\nvar myUid = process.getuid && process.getuid();\nvar myGid = process.getgid && process.getgid();\nvar loading = false;\nvar loadCbs = [];\nfunction load() {\n  var cli, builtin, cb;\n  for (var i = 0; i < arguments.length; i++) {\n    switch (typeof arguments[i]) {\n      case 'string':\n        builtin = arguments[i];\n        break;\n      case 'object':\n        cli = arguments[i];\n        break;\n      case 'function':\n        cb = arguments[i];\n        break;\n    }\n  }\n  if (!cb) cb = function () {};\n  if (exports.loaded) {\n    var ret = exports.loaded;\n    if (cli) {\n      ret = new Conf(ret);\n      ret.unshift(cli);\n    }\n    return process.nextTick(cb.bind(null, null, ret));\n  }\n\n  // either a fresh object, or a clone of the passed in obj\n  if (!cli) {\n    cli = {};\n  } else {\n    cli = Object.keys(cli).reduce(function (c, k) {\n      c[k] = cli[k];\n      return c;\n    }, {});\n  }\n  loadCbs.push(cb);\n  if (loading) return;\n  loading = true;\n  cb = once(function (er, conf) {\n    if (!er) {\n      exports.loaded = conf;\n      loading = false;\n    }\n    loadCbs.forEach(function (fn) {\n      fn(er, conf);\n    });\n    loadCbs.length = 0;\n  });\n\n  // check for a builtin if provided.\n  exports.usingBuiltin = !!builtin;\n  var rc = exports.rootConf = new Conf();\n  if (builtin) {\n    rc.addFile(builtin, 'builtin');\n  } else {\n    rc.add({}, 'builtin');\n  }\n  rc.on('load', function () {\n    load_(builtin, rc, cli, cb);\n  });\n  rc.on('error', cb);\n}\nfunction load_(builtin, rc, cli, cb) {\n  var defaults = configDefs.defaults;\n  var conf = new Conf(rc);\n  conf.usingBuiltin = !!builtin;\n  conf.add(cli, 'cli');\n  conf.addEnv();\n  conf.loadPrefix(function (er) {\n    if (er) return cb(er);\n\n    // If you're doing `npm --userconfig=~/foo.npmrc` then you'd expect\n    // that ~/.npmrc won't override the stuff in ~/foo.npmrc (or, indeed\n    // be used at all).\n    //\n    // However, if the cwd is ~, then ~/.npmrc is the home for the project\n    // config, and will override the userconfig.\n    //\n    // If you're not setting the userconfig explicitly, then it will be loaded\n    // twice, which is harmless but excessive.  If you *are* setting the\n    // userconfig explicitly then it will override your explicit intent, and\n    // that IS harmful and unexpected.\n    //\n    // Solution: Do not load project config file that is the same as either\n    // the default or resolved userconfig value.  npm will log a \"verbose\"\n    // message about this when it happens, but it is a rare enough edge case\n    // that we don't have to be super concerned about it.\n    var projectConf = path.resolve(conf.localPrefix, '.npmrc');\n    var defaultUserConfig = rc.get('userconfig');\n    var resolvedUserConfig = conf.get('userconfig');\n    if (!conf.get('global') && projectConf !== defaultUserConfig && projectConf !== resolvedUserConfig) {\n      conf.addFile(projectConf, 'project');\n      conf.once('load', afterPrefix);\n    } else {\n      conf.add({}, 'project');\n      afterPrefix();\n    }\n  });\n  function afterPrefix() {\n    conf.addFile(conf.get('userconfig'), 'user');\n    conf.once('error', cb);\n    conf.once('load', afterUser);\n  }\n  function afterUser() {\n    // globalconfig and globalignorefile defaults\n    // need to respond to the 'prefix' setting up to this point.\n    // Eg, `npm config get globalconfig --prefix ~/local` should\n    // return `~/local/etc/npmrc`\n    // annoying humans and their expectations!\n    if (conf.get('prefix')) {\n      var etc = path.resolve(conf.get('prefix'), 'etc');\n      defaults.globalconfig = path.resolve(etc, 'npmrc');\n      defaults.globalignorefile = path.resolve(etc, 'npmignore');\n    }\n    conf.addFile(conf.get('globalconfig'), 'global');\n\n    // move the builtin into the conf stack now.\n    conf.root = defaults;\n    conf.add(rc.shift(), 'builtin');\n    conf.once('load', function () {\n      conf.loadExtras(afterExtras);\n    });\n  }\n  function afterExtras(er) {\n    if (er) return cb(er);\n\n    // warn about invalid bits.\n    validate(conf);\n    var cafile = conf.get('cafile');\n    if (cafile) {\n      return conf.loadCAFile(cafile, finalize);\n    }\n    finalize();\n  }\n  function finalize(er) {\n    if (er) {\n      return cb(er);\n    }\n    exports.loaded = conf;\n    cb(er, conf);\n  }\n}\n\n// Basically the same as CC, but:\n// 1. Always ini\n// 2. Parses environment variable names in field values\n// 3. Field values that start with ~/ are replaced with process.env.HOME\n// 4. Can inherit from another Conf object, using it as the base.\ninherits(Conf, CC);\nfunction Conf(base) {\n  if (!(this instanceof Conf)) return new Conf(base);\n  CC.call(this);\n  if (base) {\n    if (base instanceof Conf) {\n      this.root = base.list[0] || base.root;\n    } else {\n      this.root = base;\n    }\n  } else {\n    this.root = configDefs.defaults;\n  }\n}\nConf.prototype.loadPrefix = require('./load-prefix.js');\nConf.prototype.loadCAFile = require('./load-cafile.js');\nConf.prototype.setUser = require('./set-user.js');\nConf.prototype.getCredentialsByURI = require('./get-credentials-by-uri.js');\nConf.prototype.setCredentialsByURI = require('./set-credentials-by-uri.js');\nConf.prototype.clearCredentialsByURI = require('./clear-credentials-by-uri.js');\nConf.prototype.loadExtras = function (cb) {\n  this.setUser(function (er) {\n    if (er) return cb(er);\n    // Without prefix, nothing will ever work\n    mkdirp(this.prefix, cb);\n  }.bind(this));\n};\nConf.prototype.save = function (where, cb) {\n  var target = this.sources[where];\n  if (!target || !(target.path || target.source) || !target.data) {\n    var er;\n    if (where !== 'builtin') er = new Error('bad save target: ' + where);\n    if (cb) {\n      process.nextTick(cb.bind(null, er));\n      return this;\n    }\n    return this.emit('error', er);\n  }\n  if (target.source) {\n    var pref = target.prefix || '';\n    Object.keys(target.data).forEach(function (k) {\n      target.source[pref + k] = target.data[k];\n    });\n    if (cb) process.nextTick(cb);\n    return this;\n  }\n  var data = ini.stringify(target.data);\n  var then = function then(er) {\n    if (er) return done(er);\n    fs.chmod(target.path, mode, done);\n  };\n  var done = function done(er) {\n    if (er) {\n      if (cb) return cb(er);else return this.emit('error', er);\n    }\n    this._saving--;\n    if (this._saving === 0) {\n      if (cb) cb();\n      this.emit('save');\n    }\n  };\n  then = then.bind(this);\n  done = done.bind(this);\n  this._saving++;\n  var mode = where === 'user' ? '0600' : '0666';\n  if (!data.trim()) {\n    fs.unlink(target.path, function () {\n      // ignore the possible error (e.g. the file doesn't exist)\n      done(null);\n    });\n  } else {\n    // we don't have to use inferOwner here, because gentle-fs will\n    // mkdir with the correctly inferred ownership.  Just preserve it.\n    const dir = path.dirname(target.path);\n    mkdirp(dir, function (er) {\n      if (er) return then(er);\n      fs.stat(dir, (er, st) => {\n        if (er) return then(er);\n        fs.writeFile(target.path, data, 'utf8', function (er) {\n          if (er) return then(er);\n          if (myUid === 0 && (myUid !== st.uid || myGid !== st.gid)) {\n            fs.chown(target.path, st.uid, st.gid, then);\n          } else {\n            then();\n          }\n        });\n      });\n    });\n  }\n  return this;\n};\nConf.prototype.addFile = function (file, name) {\n  name = name || file;\n  var marker = {\n    __source__: name\n  };\n  this.sources[name] = {\n    path: file,\n    type: 'ini'\n  };\n  this.push(marker);\n  this._await();\n  fs.readFile(file, 'utf8', function (er, data) {\n    // just ignore missing files.\n    if (er) return this.add({}, marker);\n    this.addString(data, file, 'ini', marker);\n  }.bind(this));\n  return this;\n};\n\n// always ini files.\nConf.prototype.parse = function (content, file) {\n  return CC.prototype.parse.call(this, content, file, 'ini');\n};\nConf.prototype.add = function (data, marker) {\n  try {\n    Object.keys(data).forEach(function (k) {\n      const newKey = envReplace(k);\n      const newField = parseField(data[k], newKey);\n      delete data[k];\n      data[newKey] = newField;\n    });\n  } catch (e) {\n    this.emit('error', e);\n    return this;\n  }\n  return CC.prototype.add.call(this, data, marker);\n};\nConf.prototype.addEnv = function (env) {\n  env = env || process.env;\n  var conf = {};\n  Object.keys(env).filter(function (k) {\n    return k.match(/^npm_config_/i);\n  }).forEach(function (k) {\n    if (!env[k]) return;\n\n    // leave first char untouched, even if\n    // it is a '_' - convert all other to '-'\n    var p = k.toLowerCase().replace(/^npm_config_/, '').replace(/(?!^)_/g, '-');\n    conf[p] = env[k];\n  });\n  return CC.prototype.addEnv.call(this, '', conf, 'env');\n};\nfunction parseField(f, k) {\n  if (typeof f !== 'string' && !(f instanceof String)) return f;\n\n  // type can be an array or single thing.\n  var typeList = [].concat(types[k]);\n  var isPath = typeList.indexOf(path) !== -1;\n  var isBool = typeList.indexOf(Boolean) !== -1;\n  var isString = typeList.indexOf(String) !== -1;\n  var isUmask = typeList.indexOf(Umask) !== -1;\n  var isNumber = typeList.indexOf(Number) !== -1;\n  f = ('' + f).trim();\n  if (f.match(/^\".*\"$/)) {\n    try {\n      f = JSON.parse(f);\n    } catch (e) {\n      throw new Error('Failed parsing JSON config key ' + k + ': ' + f);\n    }\n  }\n  if (isBool && !isString && f === '') return true;\n  switch (f) {\n    case 'true':\n      return true;\n    case 'false':\n      return false;\n    case 'null':\n      return null;\n    case 'undefined':\n      return undefined;\n  }\n  f = envReplace(f);\n  if (isPath) {\n    var homePattern = isWindows ? /^~(\\/|\\\\)/ : /^~\\//;\n    if (f.match(homePattern) && process.env.HOME) {\n      f = path.resolve(process.env.HOME, f.substr(2));\n    }\n    f = path.resolve(f);\n  }\n  if (isUmask) f = umask.fromString(f);\n  if (isNumber && !isNaN(f)) f = +f;\n  return f;\n}\nfunction envReplace(f) {\n  if (typeof f !== 'string' || !f) return f;\n\n  // replace any ${ENV} values with the appropriate environ.\n  var envExpr = /(\\\\*)\\$\\{([^}]+)\\}/g;\n  return f.replace(envExpr, function (orig, esc, name) {\n    esc = esc.length && esc.length % 2;\n    if (esc) return orig;\n    if (undefined === process.env[name]) {\n      throw new Error('Failed to replace env in config: ' + orig);\n    }\n    return process.env[name];\n  });\n}\nfunction validate(cl) {\n  // warn about invalid configs at every level.\n  cl.list.forEach(function (conf) {\n    nopt.clean(conf, configDefs.types);\n  });\n  nopt.clean(cl.root, configDefs.types);\n}","map":{"version":3,"names":["CC","require","ConfigChain","inherits","configDefs","types","once","fs","path","nopt","ini","Umask","mkdirp","mkdir","umask","isWindows","exports","load","Conf","loaded","rootConf","usingBuiltin","defs","Object","defineProperty","get","defaults","enumerable","validate","myUid","process","getuid","myGid","getgid","loading","loadCbs","cli","builtin","cb","i","arguments","length","ret","unshift","nextTick","bind","keys","reduce","c","k","push","er","conf","forEach","fn","rc","addFile","add","on","load_","addEnv","loadPrefix","projectConf","resolve","localPrefix","defaultUserConfig","resolvedUserConfig","afterPrefix","afterUser","etc","globalconfig","globalignorefile","root","shift","loadExtras","afterExtras","cafile","loadCAFile","finalize","base","call","list","prototype","setUser","getCredentialsByURI","setCredentialsByURI","clearCredentialsByURI","prefix","save","where","target","sources","source","data","Error","emit","pref","stringify","then","done","chmod","mode","_saving","trim","unlink","dir","dirname","stat","st","writeFile","uid","gid","chown","file","name","marker","__source__","type","_await","readFile","addString","parse","content","newKey","envReplace","newField","parseField","e","env","filter","match","p","toLowerCase","replace","f","String","typeList","concat","isPath","indexOf","isBool","Boolean","isString","isUmask","isNumber","Number","JSON","undefined","homePattern","HOME","substr","fromString","isNaN","envExpr","orig","esc","cl","clean"],"sources":["/Users/hkateliev/node_modules/npm/lib/config/core.js"],"sourcesContent":["var CC = require('config-chain').ConfigChain\nvar inherits = require('inherits')\nvar configDefs = require('./defaults.js')\nvar types = configDefs.types\nvar once = require('once')\nvar fs = require('fs')\nvar path = require('path')\nvar nopt = require('nopt')\nvar ini = require('ini')\nvar Umask = configDefs.Umask\nvar mkdirp = require('gentle-fs').mkdir\nvar umask = require('../utils/umask')\nvar isWindows = require('../utils/is-windows.js')\n\nexports.load = load\nexports.Conf = Conf\nexports.loaded = false\nexports.rootConf = null\nexports.usingBuiltin = false\nexports.defs = configDefs\n\nObject.defineProperty(exports, 'defaults', { get: function () {\n  return configDefs.defaults\n},\nenumerable: true })\n\nObject.defineProperty(exports, 'types', { get: function () {\n  return configDefs.types\n},\nenumerable: true })\n\nexports.validate = validate\n\nvar myUid = process.getuid && process.getuid()\nvar myGid = process.getgid && process.getgid()\n\nvar loading = false\nvar loadCbs = []\nfunction load () {\n  var cli, builtin, cb\n  for (var i = 0; i < arguments.length; i++) {\n    switch (typeof arguments[i]) {\n      case 'string': builtin = arguments[i]; break\n      case 'object': cli = arguments[i]; break\n      case 'function': cb = arguments[i]; break\n    }\n  }\n\n  if (!cb) cb = function () {}\n\n  if (exports.loaded) {\n    var ret = exports.loaded\n    if (cli) {\n      ret = new Conf(ret)\n      ret.unshift(cli)\n    }\n    return process.nextTick(cb.bind(null, null, ret))\n  }\n\n  // either a fresh object, or a clone of the passed in obj\n  if (!cli) {\n    cli = {}\n  } else {\n    cli = Object.keys(cli).reduce(function (c, k) {\n      c[k] = cli[k]\n      return c\n    }, {})\n  }\n\n  loadCbs.push(cb)\n  if (loading) return\n\n  loading = true\n\n  cb = once(function (er, conf) {\n    if (!er) {\n      exports.loaded = conf\n      loading = false\n    }\n    loadCbs.forEach(function (fn) {\n      fn(er, conf)\n    })\n    loadCbs.length = 0\n  })\n\n  // check for a builtin if provided.\n  exports.usingBuiltin = !!builtin\n  var rc = exports.rootConf = new Conf()\n  if (builtin) {\n    rc.addFile(builtin, 'builtin')\n  } else {\n    rc.add({}, 'builtin')\n  }\n\n  rc.on('load', function () {\n    load_(builtin, rc, cli, cb)\n  })\n  rc.on('error', cb)\n}\n\nfunction load_ (builtin, rc, cli, cb) {\n  var defaults = configDefs.defaults\n  var conf = new Conf(rc)\n\n  conf.usingBuiltin = !!builtin\n  conf.add(cli, 'cli')\n  conf.addEnv()\n\n  conf.loadPrefix(function (er) {\n    if (er) return cb(er)\n\n    // If you're doing `npm --userconfig=~/foo.npmrc` then you'd expect\n    // that ~/.npmrc won't override the stuff in ~/foo.npmrc (or, indeed\n    // be used at all).\n    //\n    // However, if the cwd is ~, then ~/.npmrc is the home for the project\n    // config, and will override the userconfig.\n    //\n    // If you're not setting the userconfig explicitly, then it will be loaded\n    // twice, which is harmless but excessive.  If you *are* setting the\n    // userconfig explicitly then it will override your explicit intent, and\n    // that IS harmful and unexpected.\n    //\n    // Solution: Do not load project config file that is the same as either\n    // the default or resolved userconfig value.  npm will log a \"verbose\"\n    // message about this when it happens, but it is a rare enough edge case\n    // that we don't have to be super concerned about it.\n    var projectConf = path.resolve(conf.localPrefix, '.npmrc')\n    var defaultUserConfig = rc.get('userconfig')\n    var resolvedUserConfig = conf.get('userconfig')\n    if (!conf.get('global') &&\n        projectConf !== defaultUserConfig &&\n        projectConf !== resolvedUserConfig) {\n      conf.addFile(projectConf, 'project')\n      conf.once('load', afterPrefix)\n    } else {\n      conf.add({}, 'project')\n      afterPrefix()\n    }\n  })\n\n  function afterPrefix () {\n    conf.addFile(conf.get('userconfig'), 'user')\n    conf.once('error', cb)\n    conf.once('load', afterUser)\n  }\n\n  function afterUser () {\n    // globalconfig and globalignorefile defaults\n    // need to respond to the 'prefix' setting up to this point.\n    // Eg, `npm config get globalconfig --prefix ~/local` should\n    // return `~/local/etc/npmrc`\n    // annoying humans and their expectations!\n    if (conf.get('prefix')) {\n      var etc = path.resolve(conf.get('prefix'), 'etc')\n      defaults.globalconfig = path.resolve(etc, 'npmrc')\n      defaults.globalignorefile = path.resolve(etc, 'npmignore')\n    }\n\n    conf.addFile(conf.get('globalconfig'), 'global')\n\n    // move the builtin into the conf stack now.\n    conf.root = defaults\n    conf.add(rc.shift(), 'builtin')\n    conf.once('load', function () {\n      conf.loadExtras(afterExtras)\n    })\n  }\n\n  function afterExtras (er) {\n    if (er) return cb(er)\n\n    // warn about invalid bits.\n    validate(conf)\n\n    var cafile = conf.get('cafile')\n\n    if (cafile) {\n      return conf.loadCAFile(cafile, finalize)\n    }\n\n    finalize()\n  }\n\n  function finalize (er) {\n    if (er) {\n      return cb(er)\n    }\n\n    exports.loaded = conf\n    cb(er, conf)\n  }\n}\n\n// Basically the same as CC, but:\n// 1. Always ini\n// 2. Parses environment variable names in field values\n// 3. Field values that start with ~/ are replaced with process.env.HOME\n// 4. Can inherit from another Conf object, using it as the base.\ninherits(Conf, CC)\nfunction Conf (base) {\n  if (!(this instanceof Conf)) return new Conf(base)\n\n  CC.call(this)\n\n  if (base) {\n    if (base instanceof Conf) {\n      this.root = base.list[0] || base.root\n    } else {\n      this.root = base\n    }\n  } else {\n    this.root = configDefs.defaults\n  }\n}\n\nConf.prototype.loadPrefix = require('./load-prefix.js')\nConf.prototype.loadCAFile = require('./load-cafile.js')\nConf.prototype.setUser = require('./set-user.js')\nConf.prototype.getCredentialsByURI = require('./get-credentials-by-uri.js')\nConf.prototype.setCredentialsByURI = require('./set-credentials-by-uri.js')\nConf.prototype.clearCredentialsByURI = require('./clear-credentials-by-uri.js')\n\nConf.prototype.loadExtras = function (cb) {\n  this.setUser(function (er) {\n    if (er) return cb(er)\n    // Without prefix, nothing will ever work\n    mkdirp(this.prefix, cb)\n  }.bind(this))\n}\n\nConf.prototype.save = function (where, cb) {\n  var target = this.sources[where]\n  if (!target || !(target.path || target.source) || !target.data) {\n    var er\n    if (where !== 'builtin') er = new Error('bad save target: ' + where)\n    if (cb) {\n      process.nextTick(cb.bind(null, er))\n      return this\n    }\n    return this.emit('error', er)\n  }\n\n  if (target.source) {\n    var pref = target.prefix || ''\n    Object.keys(target.data).forEach(function (k) {\n      target.source[pref + k] = target.data[k]\n    })\n    if (cb) process.nextTick(cb)\n    return this\n  }\n\n  var data = ini.stringify(target.data)\n\n  var then = function then (er) {\n    if (er) return done(er)\n\n    fs.chmod(target.path, mode, done)\n  }\n\n  var done = function done (er) {\n    if (er) {\n      if (cb) return cb(er)\n      else return this.emit('error', er)\n    }\n    this._saving--\n    if (this._saving === 0) {\n      if (cb) cb()\n      this.emit('save')\n    }\n  }\n\n  then = then.bind(this)\n  done = done.bind(this)\n  this._saving++\n\n  var mode = where === 'user' ? '0600' : '0666'\n  if (!data.trim()) {\n    fs.unlink(target.path, function () {\n      // ignore the possible error (e.g. the file doesn't exist)\n      done(null)\n    })\n  } else {\n    // we don't have to use inferOwner here, because gentle-fs will\n    // mkdir with the correctly inferred ownership.  Just preserve it.\n    const dir = path.dirname(target.path)\n    mkdirp(dir, function (er) {\n      if (er) return then(er)\n      fs.stat(dir, (er, st) => {\n        if (er) return then(er)\n        fs.writeFile(target.path, data, 'utf8', function (er) {\n          if (er) return then(er)\n          if (myUid === 0 && (myUid !== st.uid || myGid !== st.gid)) {\n            fs.chown(target.path, st.uid, st.gid, then)\n          } else {\n            then()\n          }\n        })\n      })\n    })\n  }\n\n  return this\n}\n\nConf.prototype.addFile = function (file, name) {\n  name = name || file\n  var marker = { __source__: name }\n  this.sources[name] = { path: file, type: 'ini' }\n  this.push(marker)\n  this._await()\n  fs.readFile(file, 'utf8', function (er, data) {\n    // just ignore missing files.\n    if (er) return this.add({}, marker)\n\n    this.addString(data, file, 'ini', marker)\n  }.bind(this))\n  return this\n}\n\n// always ini files.\nConf.prototype.parse = function (content, file) {\n  return CC.prototype.parse.call(this, content, file, 'ini')\n}\n\nConf.prototype.add = function (data, marker) {\n  try {\n    Object.keys(data).forEach(function (k) {\n      const newKey = envReplace(k)\n      const newField = parseField(data[k], newKey)\n      delete data[k]\n      data[newKey] = newField\n    })\n  } catch (e) {\n    this.emit('error', e)\n    return this\n  }\n  return CC.prototype.add.call(this, data, marker)\n}\n\nConf.prototype.addEnv = function (env) {\n  env = env || process.env\n  var conf = {}\n  Object.keys(env)\n    .filter(function (k) { return k.match(/^npm_config_/i) })\n    .forEach(function (k) {\n      if (!env[k]) return\n\n      // leave first char untouched, even if\n      // it is a '_' - convert all other to '-'\n      var p = k.toLowerCase()\n        .replace(/^npm_config_/, '')\n        .replace(/(?!^)_/g, '-')\n      conf[p] = env[k]\n    })\n  return CC.prototype.addEnv.call(this, '', conf, 'env')\n}\n\nfunction parseField (f, k) {\n  if (typeof f !== 'string' && !(f instanceof String)) return f\n\n  // type can be an array or single thing.\n  var typeList = [].concat(types[k])\n  var isPath = typeList.indexOf(path) !== -1\n  var isBool = typeList.indexOf(Boolean) !== -1\n  var isString = typeList.indexOf(String) !== -1\n  var isUmask = typeList.indexOf(Umask) !== -1\n  var isNumber = typeList.indexOf(Number) !== -1\n\n  f = ('' + f).trim()\n\n  if (f.match(/^\".*\"$/)) {\n    try {\n      f = JSON.parse(f)\n    } catch (e) {\n      throw new Error('Failed parsing JSON config key ' + k + ': ' + f)\n    }\n  }\n\n  if (isBool && !isString && f === '') return true\n\n  switch (f) {\n    case 'true': return true\n    case 'false': return false\n    case 'null': return null\n    case 'undefined': return undefined\n  }\n\n  f = envReplace(f)\n\n  if (isPath) {\n    var homePattern = isWindows ? /^~(\\/|\\\\)/ : /^~\\//\n    if (f.match(homePattern) && process.env.HOME) {\n      f = path.resolve(process.env.HOME, f.substr(2))\n    }\n    f = path.resolve(f)\n  }\n\n  if (isUmask) f = umask.fromString(f)\n\n  if (isNumber && !isNaN(f)) f = +f\n\n  return f\n}\n\nfunction envReplace (f) {\n  if (typeof f !== 'string' || !f) return f\n\n  // replace any ${ENV} values with the appropriate environ.\n  var envExpr = /(\\\\*)\\$\\{([^}]+)\\}/g\n  return f.replace(envExpr, function (orig, esc, name) {\n    esc = esc.length && esc.length % 2\n    if (esc) return orig\n    if (undefined === process.env[name]) {\n      throw new Error('Failed to replace env in config: ' + orig)\n    }\n\n    return process.env[name]\n  })\n}\n\nfunction validate (cl) {\n  // warn about invalid configs at every level.\n  cl.list.forEach(function (conf) {\n    nopt.clean(conf, configDefs.types)\n  })\n\n  nopt.clean(cl.root, configDefs.types)\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}