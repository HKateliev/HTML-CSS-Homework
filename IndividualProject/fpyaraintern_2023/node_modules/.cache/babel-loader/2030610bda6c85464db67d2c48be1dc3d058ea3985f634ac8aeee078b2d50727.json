{"ast":null,"code":"'use strict';\n\n// npm pack <pkg>\n// Packs the specified package into a .tgz file, which can then\n// be installed.\n\n// Set this early to avoid issues with circular dependencies.\nmodule.exports = pack;\nconst BB = require('bluebird');\nconst byteSize = require('byte-size');\nconst cacache = require('cacache');\nconst columnify = require('columnify');\nconst cp = require('child_process');\nconst deprCheck = require('./utils/depr-check');\nconst fpm = require('./fetch-package-metadata');\nconst fs = require('graceful-fs');\nconst install = require('./install');\nconst lifecycle = BB.promisify(require('./utils/lifecycle'));\nconst log = require('npmlog');\nconst move = require('move-concurrently');\nconst npm = require('./npm');\nconst npmConfig = require('./config/figgy-config.js');\nconst output = require('./utils/output');\nconst pacote = require('pacote');\nconst path = require('path');\nconst PassThrough = require('stream').PassThrough;\nconst pathIsInside = require('path-is-inside');\nconst pipe = BB.promisify(require('mississippi').pipe);\nconst prepublishWarning = require('./utils/warn-deprecated')('prepublish-on-install');\nconst pinflight = require('promise-inflight');\nconst readJson = BB.promisify(require('read-package-json'));\nconst tar = require('tar');\nconst packlist = require('npm-packlist');\nconst ssri = require('ssri');\npack.usage = 'npm pack [[<@scope>/]<pkg>...] [--dry-run]';\n\n// if it can be installed, it can be packed.\npack.completion = install.completion;\nfunction pack(args, silent, cb) {\n  const cwd = process.cwd();\n  if (typeof cb !== 'function') {\n    cb = silent;\n    silent = false;\n  }\n  if (args.length === 0) args = ['.'];\n  BB.all(args.map(arg => pack_(arg, cwd))).then(tarballs => {\n    if (!silent && npm.config.get('json')) {\n      output(JSON.stringify(tarballs, null, 2));\n    } else if (!silent) {\n      tarballs.forEach(logContents);\n      output(tarballs.map(f => path.relative(cwd, f.filename)).join('\\n'));\n    }\n    return tarballs;\n  }).nodeify(cb);\n}\nfunction pack_(pkg, dir) {\n  return BB.fromNode(cb => fpm(pkg, dir, cb)).then(mani => {\n    let name = mani.name[0] === '@'\n    // scoped packages get special treatment\n    ? mani.name.substr(1).replace(/\\//g, '-') : mani.name;\n    const target = `${name}-${mani.version}.tgz`;\n    return pinflight(target, () => {\n      const dryRun = npm.config.get('dry-run');\n      if (mani._requested.type === 'directory') {\n        return prepareDirectory(mani._resolved).then(() => {\n          return packDirectory(mani, mani._resolved, target, target, true, dryRun);\n        });\n      } else if (dryRun) {\n        log.verbose('pack', '--dry-run mode enabled. Skipping write.');\n        return cacache.tmp.withTmp(npm.tmp, {\n          tmpPrefix: 'packing'\n        }, tmp => {\n          const tmpTarget = path.join(tmp, path.basename(target));\n          return packFromPackage(pkg, tmpTarget, target);\n        });\n      } else {\n        return packFromPackage(pkg, target, target);\n      }\n    });\n  });\n}\nfunction packFromPackage(arg, target, filename) {\n  const opts = npmConfig();\n  return pacote.tarball.toFile(arg, target, opts).then(() => cacache.tmp.withTmp(npm.tmp, {\n    tmpPrefix: 'unpacking'\n  }, tmp => {\n    const tmpTarget = path.join(tmp, filename);\n    return pacote.extract(arg, tmpTarget, opts).then(() => readJson(path.join(tmpTarget, 'package.json')));\n  })).then(pkg => getContents(pkg, target, filename));\n}\nmodule.exports.prepareDirectory = prepareDirectory;\nfunction prepareDirectory(dir) {\n  return readJson(path.join(dir, 'package.json')).then(pkg => {\n    if (!pkg.name) {\n      throw new Error('package.json requires a \"name\" field');\n    }\n    if (!pkg.version) {\n      throw new Error('package.json requires a valid \"version\" field');\n    }\n    if (!pathIsInside(dir, npm.tmp)) {\n      if (pkg.scripts && pkg.scripts.prepublish) {\n        prepublishWarning(['As of npm@5, `prepublish` scripts are deprecated.', 'Use `prepare` for build steps and `prepublishOnly` for upload-only.', 'See the deprecation note in `npm help scripts` for more information.']);\n      }\n      if (npm.config.get('ignore-prepublish')) {\n        return lifecycle(pkg, 'prepare', dir).then(() => pkg);\n      } else {\n        return lifecycle(pkg, 'prepublish', dir).then(() => {\n          return lifecycle(pkg, 'prepare', dir);\n        }).then(() => pkg);\n      }\n    }\n    return pkg;\n  });\n}\nmodule.exports.packDirectory = packDirectory;\nfunction packDirectory(mani, dir, target, filename, logIt, dryRun) {\n  deprCheck(mani);\n  return readJson(path.join(dir, 'package.json')).then(pkg => {\n    return lifecycle(pkg, 'prepack', dir);\n  }).then(() => {\n    return readJson(path.join(dir, 'package.json'));\n  }).then(pkg => {\n    return cacache.tmp.withTmp(npm.tmp, {\n      tmpPrefix: 'packing'\n    }, tmp => {\n      const tmpTarget = path.join(tmp, path.basename(target));\n      const tarOpt = {\n        file: tmpTarget,\n        cwd: dir,\n        prefix: 'package/',\n        portable: true,\n        // Provide a specific date in the 1980s for the benefit of zip,\n        // which is confounded by files dated at the Unix epoch 0.\n        mtime: new Date('1985-10-26T08:15:00.000Z'),\n        gzip: true\n      };\n      return BB.resolve(packlist({\n        path: dir\n      }))\n      // NOTE: node-tar does some Magic Stuff depending on prefixes for files\n      //       specifically with @ signs, so we just neutralize that one\n      //       and any such future \"features\" by prepending `./`\n      .then(files => tar.create(tarOpt, files.map(f => `./${f}`))).then(() => getContents(pkg, tmpTarget, filename, logIt))\n      // thread the content info through\n      .tap(() => {\n        if (dryRun) {\n          log.verbose('pack', '--dry-run mode enabled. Skipping write.');\n        } else {\n          return move(tmpTarget, target, {\n            Promise: BB,\n            fs\n          });\n        }\n      }).tap(() => lifecycle(pkg, 'postpack', dir));\n    });\n  });\n}\nmodule.exports.logContents = logContents;\nfunction logContents(tarball) {\n  log.notice('');\n  log.notice('', `${npm.config.get('unicode') ? 'ðŸ“¦ ' : 'package:'} ${tarball.name}@${tarball.version}`);\n  log.notice('=== Tarball Contents ===');\n  if (tarball.files.length) {\n    log.notice('', columnify(tarball.files.map(f => {\n      const bytes = byteSize(f.size);\n      return {\n        path: f.path,\n        size: `${bytes.value}${bytes.unit}`\n      };\n    }), {\n      include: ['size', 'path'],\n      showHeaders: false\n    }));\n  }\n  if (tarball.bundled.length) {\n    log.notice('=== Bundled Dependencies ===');\n    tarball.bundled.forEach(name => log.notice('', name));\n  }\n  log.notice('=== Tarball Details ===');\n  log.notice('', columnify([{\n    name: 'name:',\n    value: tarball.name\n  }, {\n    name: 'version:',\n    value: tarball.version\n  }, tarball.filename && {\n    name: 'filename:',\n    value: tarball.filename\n  }, {\n    name: 'package size:',\n    value: byteSize(tarball.size)\n  }, {\n    name: 'unpacked size:',\n    value: byteSize(tarball.unpackedSize)\n  }, {\n    name: 'shasum:',\n    value: tarball.shasum\n  }, {\n    name: 'integrity:',\n    value: tarball.integrity.toString().substr(0, 20) + '[...]' + tarball.integrity.toString().substr(80)\n  }, tarball.bundled.length && {\n    name: 'bundled deps:',\n    value: tarball.bundled.length\n  }, tarball.bundled.length && {\n    name: 'bundled files:',\n    value: tarball.entryCount - tarball.files.length\n  }, tarball.bundled.length && {\n    name: 'own files:',\n    value: tarball.files.length\n  }, {\n    name: 'total files:',\n    value: tarball.entryCount\n  }].filter(x => x), {\n    include: ['name', 'value'],\n    showHeaders: false\n  }));\n  log.notice('', '');\n}\nmodule.exports.getContents = getContents;\nfunction getContents(pkg, target, filename, silent) {\n  const bundledWanted = new Set(pkg.bundleDependencies || pkg.bundledDependencies || []);\n  const files = [];\n  const bundled = new Set();\n  let totalEntries = 0;\n  let totalEntrySize = 0;\n  return tar.t({\n    file: target,\n    onentry(entry) {\n      totalEntries++;\n      totalEntrySize += entry.size;\n      const p = entry.path;\n      if (p.startsWith('package/node_modules/')) {\n        const name = p.match(/^package\\/node_modules\\/((?:@[^/]+\\/)?[^/]+)/)[1];\n        if (bundledWanted.has(name)) {\n          bundled.add(name);\n        }\n      } else {\n        files.push({\n          path: entry.path.replace(/^package\\//, ''),\n          size: entry.size,\n          mode: entry.mode\n        });\n      }\n    },\n    strip: 1\n  }).then(() => BB.all([BB.fromNode(cb => fs.stat(target, cb)), ssri.fromStream(fs.createReadStream(target), {\n    algorithms: ['sha1', 'sha512']\n  })])).then(_ref => {\n    let [stat, integrity] = _ref;\n    const shasum = integrity['sha1'][0].hexDigest();\n    return {\n      id: pkg._id,\n      name: pkg.name,\n      version: pkg.version,\n      from: pkg._from,\n      size: stat.size,\n      unpackedSize: totalEntrySize,\n      shasum,\n      integrity: ssri.parse(integrity['sha512'][0]),\n      filename,\n      files,\n      entryCount: totalEntries,\n      bundled: Array.from(bundled)\n    };\n  });\n}\nconst PASSTHROUGH_OPTS = ['always-auth', 'auth-type', 'ca', 'cafile', 'cert', 'git', 'local-address', 'maxsockets', 'offline', 'prefer-offline', 'prefer-online', 'proxy', 'https-proxy', 'registry', 'send-metrics', 'sso-poll-frequency', 'sso-type', 'strict-ssl'];\nmodule.exports.packGitDep = packGitDep;\nfunction packGitDep(manifest, dir) {\n  const stream = new PassThrough();\n  readJson(path.join(dir, 'package.json')).then(pkg => {\n    if (pkg.scripts && pkg.scripts.prepare) {\n      log.verbose('prepareGitDep', `${manifest._spec}: installing devDeps and running prepare script.`);\n      const cliArgs = PASSTHROUGH_OPTS.reduce((acc, opt) => {\n        if (npm.config.get(opt, 'cli') != null) {\n          acc.push(`--${opt}=${npm.config.get(opt)}`);\n        }\n        return acc;\n      }, []);\n      const child = cp.spawn(process.env.NODE || process.execPath, [require.resolve('../bin/npm-cli.js'), 'install', '--dev', '--prod', '--ignore-prepublish', '--no-progress', '--no-save'].concat(cliArgs), {\n        cwd: dir,\n        env: process.env\n      });\n      let errData = [];\n      let errDataLen = 0;\n      let outData = [];\n      let outDataLen = 0;\n      child.stdout.on('data', data => {\n        outData.push(data);\n        outDataLen += data.length;\n        log.gauge.pulse('preparing git package');\n      });\n      child.stderr.on('data', data => {\n        errData.push(data);\n        errDataLen += data.length;\n        log.gauge.pulse('preparing git package');\n      });\n      return BB.fromNode(cb => {\n        child.on('error', cb);\n        child.on('exit', (code, signal) => {\n          if (code > 0) {\n            const err = new Error(`${signal}: npm exited with code ${code} while attempting to build ${manifest._requested}. Clone the repository manually and run 'npm install' in it for more information.`);\n            err.code = code;\n            err.signal = signal;\n            cb(err);\n          } else {\n            cb();\n          }\n        });\n      }).then(() => {\n        if (outDataLen > 0) log.silly('prepareGitDep', '1>', Buffer.concat(outData, outDataLen).toString());\n        if (errDataLen > 0) log.silly('prepareGitDep', '2>', Buffer.concat(errData, errDataLen).toString());\n      }, err => {\n        if (outDataLen > 0) log.error('prepareGitDep', '1>', Buffer.concat(outData, outDataLen).toString());\n        if (errDataLen > 0) log.error('prepareGitDep', '2>', Buffer.concat(errData, errDataLen).toString());\n        throw err;\n      });\n    }\n  }).then(() => {\n    return readJson(path.join(dir, 'package.json'));\n  }).then(pkg => {\n    return cacache.tmp.withTmp(npm.tmp, {\n      tmpPrefix: 'pacote-packing'\n    }, tmp => {\n      const tmpTar = path.join(tmp, 'package.tgz');\n      return packDirectory(manifest, dir, tmpTar).then(() => {\n        return pipe(fs.createReadStream(tmpTar), stream);\n      });\n    });\n  }).catch(err => stream.emit('error', err));\n  return stream;\n}","map":{"version":3,"names":["module","exports","pack","BB","require","byteSize","cacache","columnify","cp","deprCheck","fpm","fs","install","lifecycle","promisify","log","move","npm","npmConfig","output","pacote","path","PassThrough","pathIsInside","pipe","prepublishWarning","pinflight","readJson","tar","packlist","ssri","usage","completion","args","silent","cb","cwd","process","length","all","map","arg","pack_","then","tarballs","config","get","JSON","stringify","forEach","logContents","f","relative","filename","join","nodeify","pkg","dir","fromNode","mani","name","substr","replace","target","version","dryRun","_requested","type","prepareDirectory","_resolved","packDirectory","verbose","tmp","withTmp","tmpPrefix","tmpTarget","basename","packFromPackage","opts","tarball","toFile","extract","getContents","Error","scripts","prepublish","logIt","tarOpt","file","prefix","portable","mtime","Date","gzip","resolve","files","create","tap","Promise","notice","bytes","size","value","unit","include","showHeaders","bundled","unpackedSize","shasum","integrity","toString","entryCount","filter","x","bundledWanted","Set","bundleDependencies","bundledDependencies","totalEntries","totalEntrySize","t","onentry","entry","p","startsWith","match","has","add","push","mode","strip","stat","fromStream","createReadStream","algorithms","_ref","hexDigest","id","_id","from","_from","parse","Array","PASSTHROUGH_OPTS","packGitDep","manifest","stream","prepare","_spec","cliArgs","reduce","acc","opt","child","spawn","env","NODE","execPath","concat","errData","errDataLen","outData","outDataLen","stdout","on","data","gauge","pulse","stderr","code","signal","err","silly","Buffer","error","tmpTar","catch","emit"],"sources":["/Users/hkateliev/node_modules/npm/lib/pack.js"],"sourcesContent":["'use strict'\n\n// npm pack <pkg>\n// Packs the specified package into a .tgz file, which can then\n// be installed.\n\n// Set this early to avoid issues with circular dependencies.\nmodule.exports = pack\n\nconst BB = require('bluebird')\n\nconst byteSize = require('byte-size')\nconst cacache = require('cacache')\nconst columnify = require('columnify')\nconst cp = require('child_process')\nconst deprCheck = require('./utils/depr-check')\nconst fpm = require('./fetch-package-metadata')\nconst fs = require('graceful-fs')\nconst install = require('./install')\nconst lifecycle = BB.promisify(require('./utils/lifecycle'))\nconst log = require('npmlog')\nconst move = require('move-concurrently')\nconst npm = require('./npm')\nconst npmConfig = require('./config/figgy-config.js')\nconst output = require('./utils/output')\nconst pacote = require('pacote')\nconst path = require('path')\nconst PassThrough = require('stream').PassThrough\nconst pathIsInside = require('path-is-inside')\nconst pipe = BB.promisify(require('mississippi').pipe)\nconst prepublishWarning = require('./utils/warn-deprecated')('prepublish-on-install')\nconst pinflight = require('promise-inflight')\nconst readJson = BB.promisify(require('read-package-json'))\nconst tar = require('tar')\nconst packlist = require('npm-packlist')\nconst ssri = require('ssri')\n\npack.usage = 'npm pack [[<@scope>/]<pkg>...] [--dry-run]'\n\n// if it can be installed, it can be packed.\npack.completion = install.completion\n\nfunction pack (args, silent, cb) {\n  const cwd = process.cwd()\n  if (typeof cb !== 'function') {\n    cb = silent\n    silent = false\n  }\n\n  if (args.length === 0) args = ['.']\n\n  BB.all(\n    args.map((arg) => pack_(arg, cwd))\n  ).then((tarballs) => {\n    if (!silent && npm.config.get('json')) {\n      output(JSON.stringify(tarballs, null, 2))\n    } else if (!silent) {\n      tarballs.forEach(logContents)\n      output(tarballs.map((f) => path.relative(cwd, f.filename)).join('\\n'))\n    }\n    return tarballs\n  }).nodeify(cb)\n}\n\nfunction pack_ (pkg, dir) {\n  return BB.fromNode((cb) => fpm(pkg, dir, cb)).then((mani) => {\n    let name = mani.name[0] === '@'\n    // scoped packages get special treatment\n      ? mani.name.substr(1).replace(/\\//g, '-')\n      : mani.name\n    const target = `${name}-${mani.version}.tgz`\n    return pinflight(target, () => {\n      const dryRun = npm.config.get('dry-run')\n      if (mani._requested.type === 'directory') {\n        return prepareDirectory(mani._resolved)\n          .then(() => {\n            return packDirectory(mani, mani._resolved, target, target, true, dryRun)\n          })\n      } else if (dryRun) {\n        log.verbose('pack', '--dry-run mode enabled. Skipping write.')\n        return cacache.tmp.withTmp(npm.tmp, {tmpPrefix: 'packing'}, (tmp) => {\n          const tmpTarget = path.join(tmp, path.basename(target))\n          return packFromPackage(pkg, tmpTarget, target)\n        })\n      } else {\n        return packFromPackage(pkg, target, target)\n      }\n    })\n  })\n}\n\nfunction packFromPackage (arg, target, filename) {\n  const opts = npmConfig()\n  return pacote.tarball.toFile(arg, target, opts)\n    .then(() => cacache.tmp.withTmp(npm.tmp, {tmpPrefix: 'unpacking'}, (tmp) => {\n      const tmpTarget = path.join(tmp, filename)\n      return pacote.extract(arg, tmpTarget, opts)\n        .then(() => readJson(path.join(tmpTarget, 'package.json')))\n    }))\n    .then((pkg) => getContents(pkg, target, filename))\n}\n\nmodule.exports.prepareDirectory = prepareDirectory\nfunction prepareDirectory (dir) {\n  return readJson(path.join(dir, 'package.json')).then((pkg) => {\n    if (!pkg.name) {\n      throw new Error('package.json requires a \"name\" field')\n    }\n    if (!pkg.version) {\n      throw new Error('package.json requires a valid \"version\" field')\n    }\n    if (!pathIsInside(dir, npm.tmp)) {\n      if (pkg.scripts && pkg.scripts.prepublish) {\n        prepublishWarning([\n          'As of npm@5, `prepublish` scripts are deprecated.',\n          'Use `prepare` for build steps and `prepublishOnly` for upload-only.',\n          'See the deprecation note in `npm help scripts` for more information.'\n        ])\n      }\n      if (npm.config.get('ignore-prepublish')) {\n        return lifecycle(pkg, 'prepare', dir).then(() => pkg)\n      } else {\n        return lifecycle(pkg, 'prepublish', dir).then(() => {\n          return lifecycle(pkg, 'prepare', dir)\n        }).then(() => pkg)\n      }\n    }\n    return pkg\n  })\n}\n\nmodule.exports.packDirectory = packDirectory\nfunction packDirectory (mani, dir, target, filename, logIt, dryRun) {\n  deprCheck(mani)\n  return readJson(path.join(dir, 'package.json')).then((pkg) => {\n    return lifecycle(pkg, 'prepack', dir)\n  }).then(() => {\n    return readJson(path.join(dir, 'package.json'))\n  }).then((pkg) => {\n    return cacache.tmp.withTmp(npm.tmp, {tmpPrefix: 'packing'}, (tmp) => {\n      const tmpTarget = path.join(tmp, path.basename(target))\n\n      const tarOpt = {\n        file: tmpTarget,\n        cwd: dir,\n        prefix: 'package/',\n        portable: true,\n        // Provide a specific date in the 1980s for the benefit of zip,\n        // which is confounded by files dated at the Unix epoch 0.\n        mtime: new Date('1985-10-26T08:15:00.000Z'),\n        gzip: true\n      }\n\n      return BB.resolve(packlist({ path: dir }))\n      // NOTE: node-tar does some Magic Stuff depending on prefixes for files\n      //       specifically with @ signs, so we just neutralize that one\n      //       and any such future \"features\" by prepending `./`\n        .then((files) => tar.create(tarOpt, files.map((f) => `./${f}`)))\n        .then(() => getContents(pkg, tmpTarget, filename, logIt))\n        // thread the content info through\n        .tap(() => {\n          if (dryRun) {\n            log.verbose('pack', '--dry-run mode enabled. Skipping write.')\n          } else {\n            return move(tmpTarget, target, {Promise: BB, fs})\n          }\n        })\n        .tap(() => lifecycle(pkg, 'postpack', dir))\n    })\n  })\n}\n\nmodule.exports.logContents = logContents\nfunction logContents (tarball) {\n  log.notice('')\n  log.notice('', `${npm.config.get('unicode') ? 'ðŸ“¦ ' : 'package:'} ${tarball.name}@${tarball.version}`)\n  log.notice('=== Tarball Contents ===')\n  if (tarball.files.length) {\n    log.notice('', columnify(tarball.files.map((f) => {\n      const bytes = byteSize(f.size)\n      return {path: f.path, size: `${bytes.value}${bytes.unit}`}\n    }), {\n      include: ['size', 'path'],\n      showHeaders: false\n    }))\n  }\n  if (tarball.bundled.length) {\n    log.notice('=== Bundled Dependencies ===')\n    tarball.bundled.forEach((name) => log.notice('', name))\n  }\n  log.notice('=== Tarball Details ===')\n  log.notice('', columnify([\n    {name: 'name:', value: tarball.name},\n    {name: 'version:', value: tarball.version},\n    tarball.filename && {name: 'filename:', value: tarball.filename},\n    {name: 'package size:', value: byteSize(tarball.size)},\n    {name: 'unpacked size:', value: byteSize(tarball.unpackedSize)},\n    {name: 'shasum:', value: tarball.shasum},\n    {\n      name: 'integrity:',\n      value: tarball.integrity.toString().substr(0, 20) + '[...]' + tarball.integrity.toString().substr(80)},\n    tarball.bundled.length && {name: 'bundled deps:', value: tarball.bundled.length},\n    tarball.bundled.length && {name: 'bundled files:', value: tarball.entryCount - tarball.files.length},\n    tarball.bundled.length && {name: 'own files:', value: tarball.files.length},\n    {name: 'total files:', value: tarball.entryCount}\n  ].filter((x) => x), {\n    include: ['name', 'value'],\n    showHeaders: false\n  }))\n  log.notice('', '')\n}\n\nmodule.exports.getContents = getContents\nfunction getContents (pkg, target, filename, silent) {\n  const bundledWanted = new Set(\n    pkg.bundleDependencies ||\n    pkg.bundledDependencies ||\n    []\n  )\n  const files = []\n  const bundled = new Set()\n  let totalEntries = 0\n  let totalEntrySize = 0\n  return tar.t({\n    file: target,\n    onentry (entry) {\n      totalEntries++\n      totalEntrySize += entry.size\n      const p = entry.path\n      if (p.startsWith('package/node_modules/')) {\n        const name = p.match(/^package\\/node_modules\\/((?:@[^/]+\\/)?[^/]+)/)[1]\n        if (bundledWanted.has(name)) {\n          bundled.add(name)\n        }\n      } else {\n        files.push({\n          path: entry.path.replace(/^package\\//, ''),\n          size: entry.size,\n          mode: entry.mode\n        })\n      }\n    },\n    strip: 1\n  })\n    .then(() => BB.all([\n      BB.fromNode((cb) => fs.stat(target, cb)),\n      ssri.fromStream(fs.createReadStream(target), {\n        algorithms: ['sha1', 'sha512']\n      })\n    ]))\n    .then(([stat, integrity]) => {\n      const shasum = integrity['sha1'][0].hexDigest()\n      return {\n        id: pkg._id,\n        name: pkg.name,\n        version: pkg.version,\n        from: pkg._from,\n        size: stat.size,\n        unpackedSize: totalEntrySize,\n        shasum,\n        integrity: ssri.parse(integrity['sha512'][0]),\n        filename,\n        files,\n        entryCount: totalEntries,\n        bundled: Array.from(bundled)\n      }\n    })\n}\n\nconst PASSTHROUGH_OPTS = [\n  'always-auth',\n  'auth-type',\n  'ca',\n  'cafile',\n  'cert',\n  'git',\n  'local-address',\n  'maxsockets',\n  'offline',\n  'prefer-offline',\n  'prefer-online',\n  'proxy',\n  'https-proxy',\n  'registry',\n  'send-metrics',\n  'sso-poll-frequency',\n  'sso-type',\n  'strict-ssl'\n]\n\nmodule.exports.packGitDep = packGitDep\nfunction packGitDep (manifest, dir) {\n  const stream = new PassThrough()\n  readJson(path.join(dir, 'package.json')).then((pkg) => {\n    if (pkg.scripts && pkg.scripts.prepare) {\n      log.verbose('prepareGitDep', `${manifest._spec}: installing devDeps and running prepare script.`)\n      const cliArgs = PASSTHROUGH_OPTS.reduce((acc, opt) => {\n        if (npm.config.get(opt, 'cli') != null) {\n          acc.push(`--${opt}=${npm.config.get(opt)}`)\n        }\n        return acc\n      }, [])\n      const child = cp.spawn(process.env.NODE || process.execPath, [\n        require.resolve('../bin/npm-cli.js'),\n        'install',\n        '--dev',\n        '--prod',\n        '--ignore-prepublish',\n        '--no-progress',\n        '--no-save'\n      ].concat(cliArgs), {\n        cwd: dir,\n        env: process.env\n      })\n      let errData = []\n      let errDataLen = 0\n      let outData = []\n      let outDataLen = 0\n      child.stdout.on('data', (data) => {\n        outData.push(data)\n        outDataLen += data.length\n        log.gauge.pulse('preparing git package')\n      })\n      child.stderr.on('data', (data) => {\n        errData.push(data)\n        errDataLen += data.length\n        log.gauge.pulse('preparing git package')\n      })\n      return BB.fromNode((cb) => {\n        child.on('error', cb)\n        child.on('exit', (code, signal) => {\n          if (code > 0) {\n            const err = new Error(`${signal}: npm exited with code ${code} while attempting to build ${manifest._requested}. Clone the repository manually and run 'npm install' in it for more information.`)\n            err.code = code\n            err.signal = signal\n            cb(err)\n          } else {\n            cb()\n          }\n        })\n      }).then(() => {\n        if (outDataLen > 0) log.silly('prepareGitDep', '1>', Buffer.concat(outData, outDataLen).toString())\n        if (errDataLen > 0) log.silly('prepareGitDep', '2>', Buffer.concat(errData, errDataLen).toString())\n      }, (err) => {\n        if (outDataLen > 0) log.error('prepareGitDep', '1>', Buffer.concat(outData, outDataLen).toString())\n        if (errDataLen > 0) log.error('prepareGitDep', '2>', Buffer.concat(errData, errDataLen).toString())\n        throw err\n      })\n    }\n  }).then(() => {\n    return readJson(path.join(dir, 'package.json'))\n  }).then((pkg) => {\n    return cacache.tmp.withTmp(npm.tmp, {\n      tmpPrefix: 'pacote-packing'\n    }, (tmp) => {\n      const tmpTar = path.join(tmp, 'package.tgz')\n      return packDirectory(manifest, dir, tmpTar).then(() => {\n        return pipe(fs.createReadStream(tmpTar), stream)\n      })\n    })\n  }).catch((err) => stream.emit('error', err))\n  return stream\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}